\documentclass[
book,
%a4paper,					% alle weiteren Papierformat einstellbar
%landscape,					% Querformat
11pt,						% SchriftgrößŸe (12pt, 11pt (Standard))
BCOR0.8cm,					% Bindekorrektur, bspw. 1 cm
%DIVcalc,					% führt die Satzspiegelberechnung neu aus
twoside,					% einseitiges Layout
%twocolumn,					% zweispaltiger Satz
%openany,					% Kapitel können auch auf linken Seiten beginnen
%halfparskip*,				% Absatzformatierung s. scrguide 3.1
%notitlepage,				% in-page-Titel, keine eigene Titelseite
%chapterprefix,				% vor Kapitelüberschrift wird "Kapitel Nummer" gesetzt
%appendixprefix,			% Anhang wird "Anhang" vor die Üœberschrift gesetzt 
%normalheadings,			% Üœberschriften etwas kleiner (smallheadings)
%idxtotoc,					% Index im Inhaltsverzeichnis
%liststotoc,				% Abb.- und Tab.verzeichnis im Inhalt
%bibtotoc,					% Literaturverzeichnis im Inhalt
bibliography=totoc,
%leqno,						% Nummerierung von Gleichungen links
%fleqn,						% Ausgabe von Gleichungen linksbündig
%draft						% Überlangen Zeilen in Ausgabe gekennzeichnet
]{scrreprt}

% ============================ Packages ============================ 

%\usepackage[inner=3.0cm,outer=2.5cm,top=1.5cm,bottom=1.5cm,includeheadfoot]{geometry}
									% Einstellungen der Seitenränder
\usepackage[includeheadfoot]{geometry}
\usepackage[T1]{fontenc}				% neue Rechtschreibung
\usepackage[latin1]{inputenc}		         % Umlaute ermöglichen
\usepackage[german, english]{babel}
\usepackage{fancyhdr}				% für Kopf- und FußŸzeile
\usepackage[hyperref]{xcolor}		
\definecolor{MyBlue}{RGB}{50,79,132}		% für Kopf- und Fußzeile
\usepackage[colorlinks, citecolor=MyBlue, linktocpage, linkcolor=MyBlue]{hyperref}
\usepackage{color}					% Farbe
\usepackage[pdftex]{graphicx}
\usepackage{float}
\usepackage{listings}				% Programm-Code
\usepackage{longtable}				% Tabellen über mehrere Seiten
\usepackage{siunitx}				% Einheiten nach SI-Norm
\usepackage{listings}                                    % Verwendung von Matlab-Code
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage[tight]{subfigure}
\usepackage{empheq}
\usepackage{overcite}
\usepackage{url}
\usepackage{framed}
\usepackage{pdfpages}
\usepackage[compact]{titlesec}
% ============================ Kopf- und Fußzeile ==========================

\pagestyle{fancy}
\fancyhf{}

\fancyhead[CO,CE]{\scshape\leftmark}	% Kopfzeile links [L], mitte [C], rechts [R]
\fancyfoot[RO,LE]{\thepage}				% Fußzeile
\renewcommand{\headrulewidth}{0.5pt}	% Linie oben
\renewcommand{\footrulewidth}{0pt}		% Linie unten
\pagenumbering{roman}

%============================ new Definitions ============================
\include{definitions}
\include{newChapterDefinition}
\include{titlepageDefinition}
% =============================Titelseite ==================================

\begin{document}

\pagenumbering{roman}

  \LMUTitle
      {Dies ist Titel der Masterarbeit \\
       This is the title of the thesis}               % Titel der Arbeit
      {David Symhoven}                       % Vor- und Nachname des Autors
      {Witten}                             % Geburtsort des Autors
      {Computational \& Plasma Physics}                         % Name des Lehrstuhls
      {München 2017}                          % Ort und Jahr der Erstellung
      {30.06.2017}                            % Tag der Abgabe
      {Prof.Dr.Hartmut Ruhl}                          % Name des Erstgutachters
      {Zweitgutachter}                         % Name des Zweitgutachters


%======================== EINLEITUNG ========================
%===========================================================
\chapter*{Introduction}
Now it's going loose ...  \cite{Allen}\\
What is the goal of this thesis?\\
What is Plasma, and where is it used ? \\
Summary of all chapters\\

%================================= SYMBOLE UND KONTANTEN ================
\include{symbols}

%================================= Inhaltsverzeichnis ==========================
\tableofcontents

%============================ Beginn Textseiten ================================
\pagenumbering{arabic}



%================================= Bildvorlage ====================================

%Code für Bildumgebung
%\begin{figure}[H]
%	\centering
%		\includegraphics[width=0.50\textwidth]{Destruktive_Interferenz.jpg} %Bild 1
%	\caption[Destruktive Interferenz]{Destruktive Interferenz \cite{[Wiki12]}}
%	\label{fig:Interferenzfilterr}
%\end{figure}
%\noindent

%===========================================================================

%======================== FUNDAMENTALS ========================
%===========================================================
\part{Fundamentals}

%======================== Electromagnetic radiation ========================
%===========================================================
\chapter{Electromagnetic radiation}
In the first section we want to talk about electromagnetic radiation. 

\section{Maxwell-Equations}
The Maxwell equations are the foundation of the classical electromagnetism and describe how the electric field strength $\vec{E} \in \mathbb{R}^3$ and the magnetic field strength $\vec{H} \in \mathbb{R}^3$ are generated by charges and currents respectively and how they evolve over time in space in presence of one another. In presence of matter however, the interaction of the fields with the material need to be taken into account. The effect of microscopic dipols, formed by bound charge carriers, are summarized in macroscopic entities called Polarisation $\vec{P} \in \mathbb{R}^3$ and Magnetization $\vec{M} \in \mathbb{R}^3$. These dipols align in the external field such that the resulting electric and magnetic field are described by
\beq
\bal
\label{eqn: materialEquations}
\vec{D} &\coloneqq \epsilon_0 \vec{E} + \vec{P}\\
\vec{H} &\coloneqq \frac{1}{\mu_0} \vec{B} - \vec{M},
\eal
\eeq
where $\mu_0$ and $\epsilon_0$ are the vacuum permeability and the  permittivity respectively. The macroscopic Maxwell Equations than read
\beq
\label{eqn: maxwellEq}
\label{eqn: maxwell1}
\vec{\nabla} \vec{B} &=& 0\\
\label{eqn: maxwell2}
\vec{\nabla} \vec{D} &=& \rho \\
\label{eqn: maxwell3}
\vec{\nabla} \times \vec{E} &=& - \frac{\del \vec{B}}{\del t}\\
\label{eqn: maxwell4}
\vec{\nabla} \times \vec{H} &=& \frac{\del \vec{D}}{\del t} + \vec{j},
\eeq
where $\rho$ denotes the current density of the electric source and $\vec{j}$ the electric current. \\
In the case of vacuum, the material equations \eqref{eqn: materialEquations} reduce to 
\beq
\bal
\label{eqn: materialEquations}
\vec{D} &= \epsilon_0 \vec{E}\\
\vec{H} &= \frac{1}{\mu_0} \vec{B}.
\eal
\eeq

%======================== Colomb and Lorentz Gauge ========================
\section{Colomb and Lorentz Gauge}
In the following section we consider the Maxwell Equations in vacuum.\\
The electric and magnetic fields can also be described by scalar and a vector potential respectively. From \eqref{eqn: maxwell1} we can conclude that 
\beq
\label{eqn: vecA}
\exists \vec{A} \in \mathbb{R}^3 \colon \vec{B} = \vec{\nabla} \times \vec{A},
\eeq
where $\vec{A}$ is called the vector potential. Plugging in \eqref{eqn: vecA} into \eqref{eqn: maxwell3} yields
\beq
\label{eqn: varphi}
\vec{\nabla} \times \left( \vec{E} + \frac{\del \vec{A}}{\del t}\right) &=& 0.\nn \\
\Rightarrow \exists \varphi \in \mathbb{R} \colon \vec{E} + \frac{\del \vec{A}}{\del t} &=& -\vec{\nabla} \varphi.
\eeq
$\varphi$ is called scalar potential. Plugging in \eqref{eqn: varphi} into \eqref{eqn: maxwell2} and also \eqref{eqn: vecA} and \eqref{eqn: varphi} into \eqref{eqn: maxwell4} gives the potential equations
\beq
- \Delta \varphi - \vec{\nabla} \left(\frac{\del \vec{A}}{\del t}\right) &=& \frac{\rho}{\epsilon_0} \\
\underbrace{\left(\Delta- \frac{1}{c^2}\frac{\del^2}{\del t^2}\right)}_{\coloneqq \hat\square} \vec{A} - \vec{\nabla} \left(\vec{\nabla} \vec{A} + \frac{1}{c^2}\frac{\del \varphi}{\del t}\right) &=& -\mu_0\vec{j},
\eeq
where we used the \textit{Graßmann Identity}: $\vec{\nabla} \times (\vec{\nabla} \times \vec{A}) = \vec{\nabla}(\vec{\nabla}\vec{A}) - \Delta \vec{A}$.\\
The description of the fields by the aforementioned potentials $\varphi$ and $\vec{A}$ are not unique. This is called gauge freedom. The potentials can be specifically adjusted to the problem at hand. The gauge transformations look like
\beq
\bal
\vec{A} \mapsto \vec{A}' = \vec{A} + \vec{\nabla} \psi\\
\varphi \mapsto \varphi' = \varphi - \frac{\del \psi}{\del t},
\eal
\eeq
where $\psi \colon \mathbb{R}^3 \times \mathbb{R} \mapsto \mathbb{R}$. In appendix \ref{appendix: Gauge Transformations} we show, that $\psi$ does indeed not change the physics.\\
\newline
If we choose $\psi$ such that 
\beq
\vec{\nabla} \vec{A} + \frac{1}{c^2}\frac{\del \varphi}{\del t} = 0,
\eeq
then we call it \textit{Lorentz Gauge}.
\section{Liénard-Wiechert Potentials}
\label{eqn: Liénard-Wiechert}
The \textit{Liénard-Wiechert} Potentials describe the electric and magnetic fields of a moving electric particle. They are the generalization of the colomb poitential 
\beq
\bal
E = E \\
B = B 
\eal
\eeq
\label{sec: lw-potentials}

%======================== NUMERICS ========================
%===========================================================
\part{Numerics}
\noindent
The following section deals with the numeric aspects of this thesis. We explain the underlying equation of motions and their history. After that, we go into several methods with which we can solve differential equations. Over the course of the last decades numerous methods were invented each of which has its own strength and weaknesses. 
Some of them are very easy to implement, which in turn usually leads to unprecise results. Others are quite complicated and sophisticated to implement, but very accurate.
Therefore one should always consider which method is best for the problem and what it is one want to achieve.\\
Following this, we also want to define and calculate the numerical complexity of some chosen algorithms. 

%======================== Integration of equation of motion ========================
%===========================================================
\chapter{Integration of equation of motion}
%======================== Equations of Motion ========================
\section{Equations of motion}
As we know from mechanics the dynamic of a particle is determined by the forces acting on it. In our case there is a force due to electro-magnetic fields. That can be external fields, but also fields due to moving particles, as we explained in section \ref{sec: lw-potentials}.\\
The dynamics of our system is described by the \textit{Lorentz-Newton} equation
\beq
\label{eqn: Lorentz-Newton}
\bal
\frac{\dm x^{\mu}}{\dm \tau} &= u^{\mu}\\
\frac{\dm u^{\mu}}{\dm \tau} &= F^{\mu}_{~\nu}~u^{\nu} + g^{\mu},
\eal
\eeq
which derivation is quite longish, why we want to refer to literature. \\%MISSING: cite
The term $F^{\mu}_{~\nu}$ describes the electromagnetic field strength tensor
\beq
F^{\mu}_{~\nu} = 
\begin{pmatrix}
0 & E_x & E_y & E_z \\
E_x & 0 & B_z & -B_y \\
E_y & -B_z & 0 & B_x \\
E_z & B_y & -B_x & 0
\end{pmatrix}
.
\eeq
The damping term $g^{\mu}$ considers the fact that charged particles radiate fields when they are moving which leads to a loss in their kinetic energy. Within the context of classical electrodynamics Max \textit{Abraham} and Hendrick \textit{Lorentz} discussed radiation damping in their same-named equation first.
In 1938 \textit{Dirac} generalized the equation whilst taking special relativity into account. \\% MISSING: Cites
% MISSING: Details. Historisches. Abraham, Lorentz, Dirac Landau Lifschitz Gleichung usw.
We now want to deal with how to solve the Lorentz-Newton equation \eqref{eqn: Lorentz-Newton} numerically.

%======================== Euler Scheme ========================
\section{Euler-Scheme}
The most simple method is the explicit \textit{Euler}-Method. It's easy to implement but not very accurate, as we shall see later. But before we go into the details of the explicit Euler-Scheme we need to address some prerequisites all following methods will have in common. \\
Starting point will always be a first order system of the kind
\beq
\label{eqn: Euler}
\bal
\frac{\dm x^{\mu}}{\dm \tau} &= u^{\mu}\\
\frac{\dm u^{\mu}}{\dm \tau} &= f^{\mu}(x^{\nu},u^{\nu})\\
x^{\mu}(\tau_0) &= x^{\mu}_0\\
u^{\mu}(\tau_0) &= u^{\mu}_0.
\eal
\eeq
Systems of higher order can always be reduced to a first order system. \\
In order to solve the equation of motion numerically the domain needs to be discretized. Therefore we divide the time interval into N equidistant partial intervals $h$, by defining
\beq
h \coloneqq \Delta \tau = \tau_{i+1} - \tau_i. \nn
\eeq
The idea is to calculate each point along the trajectory $x^{\mu}_i = x^{\mu}(\tau_i)$ iteratively, starting from the initial values $x^{\mu}_0$ and $u^{\mu}_0$.
But to calculate these points all differential operators in  \eqref{eqn: Euler} need to be discretized as well. That is where all methods differ. Each method has its own way to discretize the differential operators.\\
The basis of the Euler-Scheme is a first order Taylor expansion of the integration variable $x^{\mu}$ in $\tau$ around $\tau_i$
\beq
\label{eqn: Taylor}
x^{\mu}(\tau_{i+1}) =  x^{\mu}(\tau_i) + \frac{\dm x^{\mu}}{\dm \tau} \Big |_{\tau=\tau_i} \underbrace{(\tau_{i+1} - \tau_i)}_{=h} + \mathcal{O}(h^2).
\eeq
Analogously for $u^{\mu}$ and solving for  $\frac{\dm x^{\mu}}{\dm \tau}$ and $\frac{\dm u^{\mu}}{\dm \tau}$ respectively yields
\beq
\bal
\frac{x^{\mu}_{i+1} - x^{\mu}_i}{h} &= u^{\mu}_i\\
\frac{u^{\mu}_{i+1} - u^{\mu}_i}{h} &= f^{\mu}(x^{\nu}_i,u^{\nu}_i).
\eal
\eeq
This way of discretizing allows a very easy calculation of $x^{\mu}_i$ according to
 \beq
\bal
x^{\mu}_{i+1} &= x^{\mu}_i + h~u^{\mu}_i\\
u^{\mu}_{i+1} &= u^{\mu}_i + h~f^{\mu}(x^{\nu}_i,u^{\nu}_i).
\eal
\eeq
In order for us to calculate the goodness of this approximation we need to introduce the \textit{Procedural Error} and the \textit{Order of Consistency} \cite{NumerikSkript}.\\
\subsection{Procedural Error  and Order of Consistency}
\newtheorem{env_definition}{Definition}[section]
\begin{env_definition}[Procedural Error  and Order of Consistency]
\label{def: Procedural Error}
Let $I \subseteq \mathbb{R}$ be a interval, $f : I \times \mathbb{R}^d \to \mathbb{R}^d$, $y : I \to \mathbb{R}^{d}$ a solution of the initial value problem
\beq
\bal
\frac{\dm}{\dm \tau}y(\tau) &= f(\tau,y(\tau)),\\
y(\tau_0) &= y_0. 
\eal
\eeq
\begin{description}
\item[(a)] The term 
\beq
\eta(\tau,h) \coloneqq y(\tau) + h f(\tau, y(\tau)) - y(\tau+h)\quad \text{for}~\tau \in I,~ 0 < h \le b - \tau
\eeq
is called local Procedural Error of the One-Step-Scheme at $\tau$ for the increment h.
\item[(b)] The One-Step-Scheme has an Order of Consistency $p \ge 1$, if the local Procedural Error fulfils
\beq
||\eta(\tau,h) || \le Ch^{p+1}\quad \text{for}~\tau \in I,~ 0 < h \le b - \tau,
\eeq 
with a constant $C\ge 0$, which is independent of $\tau$ and $h$.
\end{description}
\end{env_definition}
Descriptively the Procedural Error is the difference between the exact solution $y(\tau+h)$ and the result, which we get from the One-Step-Scheme starting from the exact solution at the earlier time step $y(\tau)$.
Figure \ref{fig: Procedural Error} illustrates the situation.
\begin{figure}[H]
	\centering
		\includegraphics[width=0.50\textwidth]{Pictures/Verfahrensfehler.png} %Bild 1
	\caption[Procedural Error]{Illustration of the Procedural Errors of an One-Step-Scheme.~ \cite{NumerikSkript}}
	\label{fig: Procedural Error}
\end{figure}
\noindent
We now want to use the definitions \ref{def: Procedural Error} to calculate the Order of Consistency of the Euler-Scheme.\\
Starting point is the system \eqref{eqn: Lorentz-Newton}. Thereby we focus on the equation for $u^{\mu}$, since $x^{\mu}$ can be easily integrated from $u^{\mu}$.
Following Definition \ref{def: Procedural Error} we have
\beq
y = u^{\mu}. \nn \\
\eeq
We get
\beq
\label{eqn: eta u}
\eta(\tau, h) = u^{\mu}(\tau_i) + h f^{\mu}(x^{\nu}, u^{\nu}) - u^{\mu}(\tau_{i+1}).
\eeq
The last term can be calculated with a Taylor-expansion analogously to \eqref{eqn: Taylor}.
\beq
\label{eqn: Taylor u}
u^{\mu}(\tau_{i+1}) =  u^{\mu}(\tau_i) + h~\frac{\dm u^{\mu}}{\dm \tau} \Big |_{s=\tau_i}  + h^2~\frac{\dm^2 u^{\mu}}{\dm \tau^2} \Big |_{s=\tau_i}.
\eeq
Plugging in \eqref{eqn: Taylor u} in \eqref{eqn: eta u} yields
\beq
\bal
\eta(\tau, h) &= u^{\mu}(\tau_i) + h\frac{\dm u^{\mu}}{\dm \tau}  - u^{\mu}(\tau_{i+1}) \\
\stackrel{ \eqref{eqn: Taylor u}}{\Longrightarrow}\eta(\tau, h) &= u^{\mu}(\tau_i) + h\frac{\dm u^{\mu}}{\dm \tau}  - u^{\mu}(\tau_i) - h\frac{\dm u^{\mu}}{\dm \tau} - h^2\frac{\dm^2 u^{\mu}}{\dm \tau^2}\\
\Longleftrightarrow\eta(\tau, h) &= \frac{\dm^2 u^{\mu}}{\dm \tau^2}~h^2 ,
\eal
\eeq
since $\frac{\dm u^{\mu}}{\dm \tau} = f^{\mu}(x^{\nu}, u^{\nu})$ holds for the Euler-Scheme. Thus
\beq
|\eta(\tau, h)| \le C h^2 \quad \text{with}~C \coloneqq \frac{1}{2} \max_{\tau \in \mathcal{D}(u^{\mu})}\left| \frac{\dm^2 u^{\mu}}{\dm \tau^2}\right|.
\eeq
$\mathcal{D}(u^{\mu})$ denotes the domain of $u^{\mu}$. Therefore, the Euler-Scheme has an Order of Consistency of one.


%======================== Leap Frog Scheme ========================
\section{Leap-Frog-Scheme}
A definitely better method is the so called \textit{Leap-Frog}-Scheme. One can easily proof that it has an Order of Consistency of two. \\
In contrast to the explicit Euler-Scheme this method has several advantages. For one it is time reversible, i.e. it is possible to reach any previous point in time from every point later in the trajectory. On the other hand the Leap-Frog-Scheme is symplectic, meaning it conserves the phase space volume from which energy and momentum conservation follows. \\
However, one disadvantage is that it's only suited for systems in which the acting force exclusively depends on the current position, but not on the velocity of the particle. This would lead to an implicit equation system which is numerically way more expensive to solve. \\
Thus the differential equation should be of the form
\beq
\frac{\dm^2 x^{\mu}}{\dm \tau^2} = \frac{\dm u^{\mu}}{\dm \tau} = f^{\mu}(x^{\nu}).
\eeq
As we already mentioned, the various methods discretize the differential operators differently
The Leap-Frog-Scheme uses
\beq
\bal
\frac{x^{\mu}_{i+1} - x^{\mu}_i}{h} &= u^{\mu}_{i+\frac{1}{2}}\\
\frac{u^{\mu}_{i+\frac{1}{2}} - u^{\mu}_{i-\frac{1}{2}}}{h} &= f^{\mu}(x^{\nu}_i).
\eal
\eeq
Solving for the new time step yields
\beq
\bal
x^{\mu}_{i+1} &= x^{\mu}_i + h u^{\mu}_{i+\frac{1}{2}}\\
u^{\mu}_{i+\frac{1}{2}} &= u^{\mu}_{i-\frac{1}{2}} + h f^{\mu}(x^{\nu}_i).
\eal
\eeq
\noindent
As we can see, position and velocity are calculated at different times. They are shifted against each other in time by $h = \frac{1}{2}$. \\
But what if we have a system in which the force depends on the velocity ? Are we stuck with expensive implicit methods ? Fortunately not. We can use the \textit{Boris} - Method.
\subsection{Boris-Method}
This method was invented in 1970 by J.P. Boris \cite{boris} and is the standard method for pushing particles in plasma simulations today. We want to solve the Lorentz-Newton equation
\beq
\label{eqn: LorentzNewton}
\bal
\frac{v_{i+\frac{1}{2}} - v_{i - \frac{1}{2}}}{h} &= \frac{q}{m}\left(\vec{E} + \frac{v_{i+\frac{1}{2}} + v_{i - \frac{1}{2}}}{2} \times \vec{B}\right)
\eal
\eeq
Boris noticed, that upon defining
\beq
\label{eqn:vMinusAndPlus}
\bal
\vec{v}_{-} &\coloneqq v_{i - \frac{1}{2}} + \frac{h}{2}\frac{q \vec{E}}{m}\quad\text{and} \\
\vec{v}_{+} &\coloneqq v_{i + \frac{1}{2}} + \frac{h}{2}\frac{q \vec{E}}{m},
\eal
\eeq
one can eliminate the electric field. Plugging in \eqref{eqn:vMinusAndPlus} into \eqref{eqn: LorentzNewton} yields
\beq
\bal
\frac{\vec{v}_{+} - \vec{v}_{-}}{h} = \frac{q}{m} (\vec{v}_{+} + \vec{v}_{-}) \times \vec{B}.
\eal
\eeq
Following the geometrical analysis in ~\cite{Birdsall} we find %MISSING:PIctures from Birdsall and rest of explaination
\begin{figure}[H]
	\centering
		\includegraphics[width=0.70\textwidth]{Pictures/borisRotation.png} 
	\caption[Caption]{Blah Blah}
	\label{fig: borisRotation}
\end{figure}
\noindent

\begin{figure}[H]
	\centering
		\includegraphics[width=0.70\textwidth]{Pictures/borisProjection.png} 
	\caption[Caption ]{Blah Blah}
	\label{fig: borisProjection}
\end{figure}
\noindent

%======================== Interpolations ========================
%===========================================================
\chapter{Interpolations}

%======================== {Linear interpolation of Trajectories ========================
\section{Linear interpolation of Trajectories}
\label{sec: Interpolation of Trajectories}
The previously presented methods calculate the particle trajectory solely at discrete points in time $x_i^{\mu}(\tau)$. Calculating Liénard-Wiechert fields according to equation \eqref{eqn: Liénard-Wiechert} however, requires the intersection point of the trajectory with the backward lightcone of the observation point. 
In most cases the calculated points of the trajectory are not lying directly on the lightcone, so we need a procedure to calculate the intersection point exactly.\\
The simplest solution is a linear interpolation between the last point inside and the first point outside the lightcone. Figure \ref{fig: Interpolation} illustrates the situation.
\begin{figure}[H]
	\centering
		\includegraphics[width=0.80\textwidth]{Pictures/LightconeNew.pdf}
	\caption[Interpolation of Trajectories]{Minkowski space showing the particle trajectory with starting point $x^{\mu}_0(t_0)$ and last point $x^{\mu}_N(t)$. The observation point $x^{\mu}_o(t)$ with its backward lightcone is also shown. If we want to calculate the Liénard-Wiechert fields at the observation point $x^{\mu}_o(t)$, we need the intersection point $x^{\mu}_c(t_{ret})$ of the trajectory with the backward lightcone. }
	\label{fig: Interpolation}
\end{figure}
\noindent
Thereto let $x_j^{\mu} \in \mathbb{R}^{3+1}$ be the last point inside and $x_{j+1}^{\mu} \in \mathbb{R}^{3+1}$ the first point outside the lightcone. Further let $x_{c}^{\mu} \in \mathbb{R}^{3+1}$ be the intersection point of interest then we get
\beq
\label{eqn: linInt}
x_c^{\mu} = x_j^{\mu} + \lambda ~\left(x_{j+1}^{\mu} - x_j^{\mu}\right),
\eeq
where $\lambda \in [0,1]$. Due to the finite speed of light the intersection point $x_c^{\mu}$ needs to fulfill
\beq
\label{eqn: constraint}
\left| \vec{x}_o(t) - \vec{x}_c(t_{ret})\right| = c~(t - t_{ret}) \Longleftrightarrow (x_o - x_c)_{\mu} (x_o - x_c)^{\mu} = 0.
\eeq
Thereby $x_o^{\mu} \in \mathbb{R}^{3+1}$ denotes the observation point where the fields shall be calculated. Note, that on the left hand side of \eqref{eqn: constraint} only spatial components of the respective four vectors are used. \\
Plugging in \eqref{eqn: linInt} in \eqref{eqn: constraint} yields

\begin{multline}
\label{eqn: quadEq}
\lambda^2 (x_{j+1} - x_j)_{\mu}(x_{j+1} - x_j)^{\mu} + \lambda~2(x_{j+1} - x_j)_{\mu}(x_j - x_o)^{\mu} + (x_j)_{\mu}(x_j)^{\mu} \\ + (x_o)_{\mu}(x_o)^{\mu} - 2(x_j)_{\mu}(x_o)^{\mu}  = 0.
\end{multline}
We define
\beq
\bal
a &\coloneqq (x_{j+1} - x_j)_{\mu}(x_{j+1} - x_j)^{\mu}\\
b &\coloneqq 2(x_{j+1} - x_j)_{\mu}(x_j - x_o)^{\mu} \\
c &\coloneqq (x_j)_{\mu}(x_j)^{\mu} + (x_o)_{\mu}(x_o)^{\mu} - 2(x_j)_{\mu}(x_o)^{\mu}. \nn
\eal
\eeq
In general the quadratic equation \eqref{eqn: quadEq} in $\lambda$ has two solutions
\beq
\lambda_{1/2} = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}. \nn
\eeq
One denotes the intersection point with the backward lightcone, the other one with the forward lightcone. Since  $\lambda \in [0,1]$ we are only interested in the larger one. 
\beq
\lambda_{1/2} = \frac{-b + \sqrt{b^2 - 4ac}}{2a}. \nn
\eeq
Plugging in $\lambda$ in \eqref{eqn: linInt} gives the desired intersection point.

%======================== trilinear interpolation of fields ========================
\section{trilinear interpolation of fields}


%======================== Hybrid Fields ========================
%===========================================================
\chapter{Hybrid Fields}
In this section we introduce the concept of hybrid fields and how this approach reduces the numerical complexity from $N^2$ to $N$.\\
Usually the numerical complexity of multi particle simulation is $N^2$, due to the interaction between each particle. In our case we need $N$ push operations for the particles. One push for each particle. In order to do that, however, we need to solve equation \eqref{eqn: Lorentz-Newton} and therefore all Liénard-Wiechert fields from the other $N-1$ particles are needed. This results in $N(N-1)$ calculations for each time step, period. If we want to calculate the Liénard-Wiechert fields, we also need to store all positions from all particles, as explained in section \ref{sec: Interpolation of Trajectories}. For a few particles such simulations are effortlessly feasible. But with increasing particle numbers such simulations may not just require more and more memory capacity but also become so time consuming that at some point we simply can not do them anylonger. That's where the hybrid field model comes in. Instead of calculating the Liénard-Wiechert fields at every time step for all particles at all grid points we save them onto the grid and propagate them through the grid using Maxwell equations. How that works in detail is explained in the following sections. 

%======================== Maxwell Equations ========================
\section{Maxwell-Equations}
% MISSING: Which one to use ? For Maxwell Pusher  the vacuum equations are suffice. For UPML we need the ones in anisotropic media
The Maxwell equations are the foundation of the classical electromagnetism and describe how the electric field $\vec{E} \in \mathbb{R}^3$ and the magnetic field $\vec{H} \in \mathbb{R}^3$ are generated by charges and currents respectively and how they evolve over time in space in presence of one another. In homogenous and isotropic media the Maxwell Equations read
\beq
\label{eqn: maxwellEq}
\bal
\epsilon_0\epsilon_r \vec{\nabla} \vec{E} &= \rho \\
\mu_0\mu_r \vec{\nabla} \vec{B} &= 0\\
\vec{\nabla} \times \vec{E} &= - \mu_0\mu_r \frac{\del \vec{B}}{\del t}\\
\vec{\nabla} \times \vec{H} &=  \epsilon_0\epsilon_r \frac{\del \vec{E}}{\del t} + \sigma \vec{E},
\eal
\eeq
where $\epsilon_0 $ and $\epsilon_r$ are the vacuum and the relative electric permeability respectively. Same holds for $\mu_0$ and $\mu_r $ for magnetic materials.
$\rho$ denotes the current density of the electric source and $\sigma$ the electric conductivity. \\
To solve the Maxwell equations numerically we need to discretize them first. The most robust and reliable way of doing this is with the \textit{Yee-Algorithm}. 

%======================== Yee Scheme ========================
\section{The Yee-Scheme}
In this section we talk about how to solve the Maxwell Equations \eqref{eqn: maxwellEq} and how to propagate the fields on a numerical grid. We thereby focus on the Maxwell Equations in vacuum, i.e. $\rho = \sigma = 0$ and $\epsilon_r = \mu_r = 1$. As can be seen in the Liénard-Wiechert formula \eqref{eqn: Liénard-Wiechert} there is a singularity for the field values at the particle position itself. Thus, we just want to propagate fields far away from the source, which is explained in more detail later.\\
\newline 
To push the fields on the grid. i.e solving for the fields at the next time step, we use the Yee - Scheme introduced by \textit{Kane Yee} in 1966 \cite{Yee66}.\\
Figure \ref{fig: YeeBox} illustrates a so called Yee-Box and the components we need to solve the curl equations of \eqref{eqn: maxwellEq}. 
\begin{figure}[H]
	\centering
		\includegraphics[width=0.70\textwidth]{Pictures/YeeBox.png} 
	\caption[Yee-Box]{An illustration of a Yee-Box which is used to solve the curl Maxwell Equations. Shown are the positions of the electric and magnetic field vector components about a cubic unit cell of the Yee space lattice.The Yee algorithm centers its E and H components in three- dimensional space so that every E component is surrounded by four circulating H components, and every H component is surrounded by four circulating E components.\cite{Taflove}.}
	\label{fig: YeeBox}
\end{figure}


%======================== Near and Far- Fields ========================
\section{Near-and Farfields}


%======================== UPML ============================
%===========================================================
\chapter{Uniaxial Perfectly Matched Layer}

\part{Summary}
\part{Appendix}
\appendix
\chapter{Gauge Transformations}
\label{appendix: Gauge Transformations}
\noindent
In this chapter we want to show, that the gauge fields leave both the electric and magnetic fields and the corresponding potential equations invariant.
\section{Invariance of Fields}
We want to show that $\vec{E}' = \vec{E}$ and $\vec{B}' = \vec{B}$.
\beq
\bal
\vec{E}' &= -\vec{\nabla} \varphi' - \frac{\del \vec{A}'}{\del t} \nn \\
&= -\vec{\nabla} \left( \varphi - \frac{\del \psi}{\del t}\right) - \frac{\del}{\del t}\left( \vec{A} + \vec{\nabla} \psi\right) \nn \\
&= -\vec{\nabla}\varphi + \vec{\nabla}\left(\frac{\del \psi}{\del t}\right) -  \frac{\del \vec{A}}{\del t} - \frac{\del}{\del t} (\vec{\nabla} \psi) \nn\\
&= \vec{E}
\eal
\eeq
and
\beq
\bal
\vec{B}' &= \vec{\nabla} \times \vec{A}' \nn\\
&= \vec{\nabla} \times \left( \vec{A} + \vec{\nabla} \psi\right)\nn\\
&= \vec{\nabla}\times \vec{A} + \vec{\nabla}\times (\vec{\nabla} \psi)\nn\\
&= \vec{B}.
\eal
\eeq
\section{Invariance of Potential Equations}
Now we want to show the invariance of the potential equations. Therefore consider
\beq
\bal
-\Delta \varphi' - \vec{\nabla}\left(\frac{\del \vec{A}'}{\del t}\right) &= \frac{\rho}{\epsilon_0} \nn\\
\Longleftrightarrow -\Delta \left(\varphi - \frac{\del \psi}{\del t} \right) - \vec{\nabla}\left[ \frac{\del}{\del t} \left(\vec{A} + \vec{\nabla}\psi\right) \right] &=\frac{\rho}{\epsilon_0} \nn\\
\Longleftrightarrow -\Delta \varphi + \Delta\left(\frac{\del \psi}{\del t}\right) - \vec{\nabla}\left(\frac{\del \vec{A}}{\del t}\right) - \vec{\nabla}\left[ \frac{\del}{\del t}\left( \vec{\nabla}\psi\right) \right] &= \frac{\rho}{\epsilon_0} \nn\\
\Longleftrightarrow -\Delta \varphi - \vec{\nabla}\left(\frac{\del \vec{A}}{\del t}\right) &= \frac{\rho}{\epsilon_0} \nn\\
\eal
\eeq
and
\beq
\bal
\square \vec{A}' - \vec{\nabla} \left(\vec{\nabla} \vec{A}' + \frac{1}{c^2}\frac{\del \varphi' }{\del t} \right) &= -\mu_0\vec{j}\nn\\
\Longleftrightarrow \hat\square \left(\vec{A} + \vec{\nabla}\psi\right) - \vec{\nabla} \left[\vec{\nabla}  \left(\vec{A} + \vec{\nabla}\psi\right) + \frac{1}{c^2}\frac{\del}{\del t} \left(\varphi - \frac{\del \psi}{\del t} \right) \right] &= -\mu_0\vec{j}\nn\\
\Longleftrightarrow \hat\square \vec{A} + \square \left(\vec{\nabla}\psi\right) - \vec{\nabla} \left[\vec{\nabla} \vec{A} + \Delta \psi + \frac{1}{c^2}\frac{\del \varphi}{\del t} -  \frac{1}{c^2}\frac{\del^2 \psi}{\del t^2} \right] &= -\mu_0\vec{j}\nn\\
\Longleftrightarrow \hat\square \vec{A} + \square \left(\vec{\nabla}\psi\right) - \vec{\nabla} \left[\vec{\nabla} \vec{A} + \square \psi +  \frac{1}{c^2}\frac{\del \varphi}{\del t} \right] &= -\mu_0\vec{j}\nn\\
\Longleftrightarrow \hat\square \vec{A} - \vec{\nabla} \left(\vec{\nabla} \vec{A} + \frac{1}{c^2}\frac{\del \varphi}{\del t} \right) &= -\mu_0\vec{j}\nn\\
\eal
\eeq
\appendix
%============================= Abbildungsverzeichnis ===========================
\listoffigures

%======================== Literaturverzeichnis ========================

\bibliography{reference}{}
\bibliographystyle{plain}

%================================= ERKLÄRUNG=============================
\include{declaration}


\end{document}











