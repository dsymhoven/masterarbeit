\documentclass[
a4paper,					% alle weiteren Papierformat einstellbar
%landscape,					% Querformat
11pt,						% SchriftgrößŸe (12pt, 11pt (Standard))
BCOR0.8cm,					% Bindekorrektur, bspw. 1 cm
%DIVcalc,					% führt die Satzspiegelberechnung neu aus
twoside,					% einseitiges Layout
%twocolumn,					% zweispaltiger Satz
%openany,					% Kapitel können auch auf linken Seiten beginnen
%halfparskip*,				% Absatzformatierung s. scrguide 3.1
%notitlepage,				% in-page-Titel, keine eigene Titelseite
%chapterprefix,				% vor Kapitelüberschrift wird "Kapitel Nummer" gesetzt
%appendixprefix,			% Anhang wird "Anhang" vor die Üœberschrift gesetzt 
%normalheadings,			% Üœberschriften etwas kleiner (smallheadings)
%idxtotoc,					% Index im Inhaltsverzeichnis
%liststotoc,				% Abb.- und Tab.verzeichnis im Inhalt
%bibtotoc,					% Literaturverzeichnis im Inhalt
bibliography=totoc,
%leqno,						% Nummerierung von Gleichungen links
%fleqn,						% Ausgabe von Gleichungen linksbündig
%draft						% Überlangen Zeilen in Ausgabe gekennzeichnet
]{scrreprt}

% ============================ Packages ============================ 

\usepackage[inner=3.0cm,outer=2.5cm,top=1.5cm,bottom=1.5cm,includeheadfoot]{geometry}
									% Einstellungen der Seitenränder

\usepackage[T1]{fontenc}				% neue Rechtschreibung
\usepackage[latin1]{inputenc}		         % Umlaute ermöglichen
\usepackage[german, english]{babel}
\usepackage{fancyhdr}				% für Kopf- und FußŸzeile
\usepackage[hyperref]{xcolor}		
\definecolor{MyBlue}{RGB}{50,79,132}		% für Kopf- und Fußzeile
\usepackage[colorlinks, citecolor=MyBlue, linktocpage, linkcolor=MyBlue]{hyperref}
\usepackage{color}					% Farbe
\usepackage[pdftex]{graphicx}
\usepackage{float}
\usepackage{listings}				% Programm-Code
\usepackage{longtable}				% Tabellen über mehrere Seiten
\usepackage{siunitx}				% Einheiten nach SI-Norm
\usepackage{listings}                                    % Verwendung von Matlab-Code
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage[tight]{subfigure}
\usepackage{empheq}
\usepackage{overcite}
\usepackage{url}
\usepackage{framed}
\usepackage{pdfpages}
\usepackage[compact]{titlesec}
% ============================ Kopf- und Fußzeile ==========================

\pagestyle{fancy}
\fancyhf{}

\fancyhead[CO,CE]{\scshape\leftmark}	% Kopfzeile links [L], mitte [C], rechts [R]
\fancyfoot[RO,LE]{\thepage}				% Fußzeile
\renewcommand{\headrulewidth}{0.5pt}	% Linie oben
\renewcommand{\footrulewidth}{0pt}		% Linie unten
\pagenumbering{roman}

%============================ new Definitions ============================
\include{definitions}
\include{newChapterDefinition}
% =============================Titelseite ==================================

\begin{document}

\pagenumbering{roman}
\include{titlepage}

%================================= ERKLÄRUNG=============================
\include{declaration}

%================================= ABSTRACT==============================
\include{abstract}

%================================= SYMBOLE UND KONTANTEN ================
\include{symbols}

%================================= Inhaltsverzeichnis ==========================
\tableofcontents

%============================ Beginn Textseiten ================================
\pagenumbering{arabic}



%================================= Bildvorlage ====================================

%Code für Bildumgebung
%\begin{figure}[H]
	%\centering
	%	\includegraphics[width=0.50\textwidth]{Destruktive_Interferenz.jpg} %Bild 1
	%\caption[Destruktive Interferenz]{Destruktive Interferenz \cite{[Wiki12]}}
	%\label{fig:Interferenzfilterr}
%\end{figure}

%===========================================================================


%======================== EINLEITUNG ========================
%===========================================================
\chapter{Introduction}
Now it's going loose ...  \cite{Allen}

\chapter{Fundamentals}
\section{Liénard-Wiechert Potentials}
\label{sec: lw-potentials}
\section{Numerics}
\noindent
The following section deals with the numeric aspects of this thesis. We explain the underlying equation of motions and their history. After that, we go into several methods with which we can solve differential equations. Over the course of the last decades numerous methods were invented each of which has its own strength and weaknesses. 
Some of them are very easy to implement, which in turn usually leads to unprecise results. Others are quite complicated and sophisticated to implement, but very accurate.
Therefore one should always consider which method is best for the problem and what it is one want to to achieve.\\
Following this, we also want to define and calculate the numerical complexity of some chosen algorithms. 

\subsection{euqations of motion}
As we know from mechanics the dynamic of a particle is determined by the forces acting on it. In our case there is a force due to electro-magnetic fields. That can be external fields, but also fields due to moving particles, as we explained in section \ref{sec: lw-potentials}.\\
The dynamics of our system is described by the \textit{Lorentz-Newton} equation
\beq
\label{eqn: Lorentz-Newton}
\bal
\frac{\dm x^{\mu}}{\dm \tau} &= u^{\mu}\\
\frac{\dm u^{\mu}}{\dm \tau} &= F^{\mu}_{~\nu}~u^{\nu} + g^{\mu},
\eal
\eeq
which derivation is quite longish, why we want to refer to literature. \\%MISSING: cite
The term $F^{\mu}_{~\nu}$ describes the electromagnetic field strength tensor
\beq
F^{\mu}_{~\nu} = 
\begin{pmatrix}
0 & E_x & E_y & E_z \\
E_x & 0 & B_z & -B_y \\
E_y & -B_z & 0 & B_x \\
E_z & B_y & -B_x & 0
\end{pmatrix}
.
\eeq
The damping term $g^{\mu}$ considers the fact that charged particles radiate fields when they are moving which leads to a loss in their kinetic energy. Within the context of classical electrodynamics Max \textit{Abraham} and Hendrick \textit{Lorentz} discussed radiation damping in their same-named equation first.
In 1938 \textit{Dirac} generalized the equation whilst taking special relativity into account. \\% MISSING: Cites
% MISSING: Details. Historisches. Abraham, Lorentz, Dirac Landau Lifschitz Gleichung usw.
We now want to deal with how to solve the Lorentz-Newton equation \eqref{eqn: Lorentz-Newton} numerically.
\subsection{Euler-Method}
The most simple method is the explicit \textit{Euler}-Method. It's easy to implement but not very accurate, as we shall see later. But before we go into the details of the explicit Euler-scheme we need to address some prerequisites all following methods will have in common. 
Starting point will always be a first oder system of the kind
\beq
\label{eqn: Euler}
\bal
\frac{\dm x^{\mu}}{\dm \tau} &= u^{\mu}\\
\frac{\dm u^{\mu}}{\dm \tau} &= f^{\mu}(x^{\nu},u^{\nu})\\
x^{\mu}(\tau_0) &= x^{\mu}_0\\
u^{\mu}(\tau_0) &= u^{\mu}_0.
\eal
\eeq
Systems of higher order can always be reduced to a first order system. \\
In order to solve the equation of motion numerically the domain needs to be discretized. Therefore we divide the time interval into N equidistant partial intervals $h$, such that
\beq
h \coloneqq \Delta \tau = \tau_{i+1} - \tau_i \nn
\eeq
gilt. Die Idee ist nun, dass man ausgehend von den Startwerten $x^{\mu}_0$ und $u^{\mu}_0$, iterativ jeden weiteren Punkt der Trajektorie $x^{\mu}_i = x^{\mu}(\tau_i)$ berechnet. Um diese Punkte berechnen zu können, müssen allerdings auch die Differentialoperatoren in \eqref{eqn: Euler} diskretisiert werden. Darin unterscheiden sich nun die Verfahren. Grundlage des Euler-Verfahrens bildet eine Taylorentwicklung erster Ordnung der Integrationsvariablen $x^{\mu}$ in der Variable $\tau$ um den Zeitpunkt $\tau_i$
\beq
\label{eqn: Taylor}
x^{\mu}(\tau_{i+1}) =  x^{\mu}(\tau_i) + \frac{\dm x^{\mu}}{\dm \tau} \Big |_{\tau=\tau_i} \underbrace{(\tau_{i+1} - \tau_i)}_{=h} + \mathcal{O}(h^2).
\eeq
Analoges Vorgehen für $u^{\mu}$ und auflösen nach $\frac{\dm x^{\mu}}{\dm \tau}$ bzw. $\frac{\dm u^{\mu}}{\dm \tau}$ liefert schließlich
\beq
\bal
\frac{x^{\mu}_{i+1} - x^{\mu}_i}{h} &= u^{\mu}_i\\
\frac{u^{\mu}_{i+1} - u^{\mu}_i}{h} &= f^{\mu}(x^{\nu}_i,u^{\nu}_i).
\eal
\eeq
Diese Art der Diskretisierung ermöglicht eine sehr einfach Berechnung der Punkte $x^{\mu}_i$ gemäß
 \beq
\bal
x^{\mu}_{i+1} &= x^{\mu}_i + h~u^{\mu}_i\\
u^{\mu}_{i+1} &= u^{\mu}_i + h~f^{\mu}(x^{\nu}_i,u^{\nu}_i).
\eal
\eeq
Um nun die Güte dieser Approximation zu bestimmen, benötigen wir den Begriff des \textit{Verfahrensfehlers} und der \textit{Konsistenzordung}. \cite{NumerikSkript}\\
\subsubsection{Konsistenz - und Konvergenzordnung}
\newtheorem{env_definition}{Definition}[section]
\begin{env_definition}[Verfahrensfehler und Konsistenzordnung]
\label{def: Verfahrensfehler}
Sei $I \subseteq \mathbb{R}$ ein Intervall, $f : I \times \mathbb{R}^d \to \mathbb{R}^d$, $y : I \to \mathbb{R}^{d}$ eine Lösung des Anfangswertproblems
\beq
\bal
\frac{\dm}{\dm \tau}y(\tau) &= f(\tau,y(\tau)),\\
y(\tau_0) &= y_0. 
\eal
\eeq
\begin{description}
\item[(a)] Die Größe 
\beq
\eta(\tau,h) \coloneqq y(\tau) + h f(\tau, y(\tau)) - y(\tau+h)\quad \text{für}~\tau \in I,~ 0 < h \le b - \tau
\eeq
heißt lokaler Verfahrensfehler des Einschrittverfahrens im Punkt $\tau$ zur Schrittweite h.
\item[(b)] Das Einschrittverfahren besitzt die Konsistenzordnung $p \ge 1$, wenn für den lokalen Verfahrensfehler die Ungleichung
\beq
||\eta(\tau,h) || \le Ch^{p+1}\quad \text{für}~\tau \in I,~ 0 < h \le b - \tau,
\eeq 
mit einer von $\tau$ und h unabhängigen Konstanten $C\ge 0$ erfüllt ist. 
\end{description}
\end{env_definition}
Anschaulich ist der Verfahrensfehler die Differenz zwischen der exakten Lösung $y(\tau+h)$ und dem Ergebnis, das man durch das Einschrittverfahren erhält, wenn man von der exakten Lösung zum früheren Zeitpunkt $y(\tau)$ startet. Abbildung \ref{fig: Verfahrensfehler} veranschaulicht die Situation.
\begin{figure}[H]
	\centering
		\includegraphics[width=0.50\textwidth]{Pictures/Verfahrensfehler.png} %Bild 1
	\caption[Verfahrensfehler]{Veranschaulichung des Verfahrensfehlers eines Einschrittverfahrens.~ \cite{NumerikSkript}}
	\label{fig: Verfahrensfehler}
\end{figure}
\noindent
Wir wollen nun die Definitionen anwenden, um die Konsistenzordnung des Euler-Verfahrens zu bestimmen. \\
Ausgangspunkt ist das System \eqref{eqn: Lorentz-Newton}. Dabei konzentrieren wir uns nur auf die Gleichung für $u^{\mu}$, da $x^{\mu}$ einfach aus $u^{\mu}$ integriert werden kann.
Nach Definition \ref{def: Verfahrensfehler} gilt für unser System
\beq
y = u^{\mu}. \nn \\
\eeq
Wir erhalten
\beq
\label{eqn: eta u}
\eta(\tau, h) = u^{\mu}(\tau_i) + h f^{\mu}(x^{\nu}, u^{\nu}) - u^{\mu}(\tau_{i+1}).
\eeq
Den letzten Term berechnen wir mithilfe einer Taylorentwicklung analog zu \eqref{eqn: Taylor}
\beq
\label{eqn: Taylor u}
u^{\mu}(\tau_{i+1}) =  u^{\mu}(\tau_i) + h~\frac{\dm u^{\mu}}{\dm \tau} \Big |_{s=\tau_i}  + h^2~\frac{\dm^2 u^{\mu}}{\dm \tau^2} \Big |_{s=\tau_i}.
\eeq
Einsetzen von \eqref{eqn: Taylor u} in \eqref{eqn: eta u} liefert
\beq
\bal
\eta(\tau, h) &= u^{\mu}(\tau_i) + h\frac{\dm u^{\mu}}{\dm \tau}  - u^{\mu}(\tau_{i+1}) \\
\eta(\tau, h) &= u^{\mu}(\tau_i) + h\frac{\dm u^{\mu}}{\dm \tau}  - u^{\mu}(\tau_i) - h\frac{\dm u^{\mu}}{\dm \tau} - h^2\frac{\dm^2 u^{\mu}}{\dm \tau^2}\\
\eta(\tau, h) &= \frac{\dm^2 u^{\mu}}{\dm \tau^2}~h^2 ,
\eal
\eeq
da $\frac{\dm u^{\mu}}{\dm \tau} = f^{\mu}(x^{\nu}, u^{\nu})$ für das Euler-Verfahren gilt. Daraus folgt
\beq
|\eta(\tau, h)| \le C h^2 \quad \text{mit}~C \coloneqq \frac{1}{2} \max_{\tau \in \mathcal{D}(u^{\mu})}\left| \frac{\dm^2 u^{\mu}}{\dm \tau^2}\right|.
\eeq
$\mathcal{D}(u^{\mu})$ bezeichnet dabei den Definitionsbereich von $u^{\mu}$. Das Euler-Verfahren hat also Konsistenzordnung eins.

\subsection{Leap-Frog-Verfahren}
Ein deutlich besseres Verfahren ist das \textit{Leap-Frog}-Verfahren, das eine Konsistenzordnung von zwei hat, wie man leicht nachrechnen kann. \\
Im Vergleich zum expliziten Euler-Verfahren hat diese Methode mehrere Vorteile. Sie ist zum einen zeitlich umkehrbar (reversibel), d.h. man kann von jedem Zeitpunkt aus, zu jedem vorherigen Zeitpunkt zurückkehren und zum anderen ist dieses Verfahren \textit{symplektisch}, d.h. es erhält das Phasenraumvolumen, woraus Energie - und Impulserhaltung folgt.\\
Ein Nachteil des Verfahrens ist jedoch, dass es sich nur gut für Systeme eignet, bei denen die Kraft lediglich vom aktuellen Ort, nicht aber von der Geschwindigkeit des Teilchens abhängt, da es sich sonst um eine implizite Gleichung handeln würde, die sich nur deutlich rechenaufwändiger lösen ließe.\\
Die zu lösende Differentialgleichung sollte also von folgender Gestalt sein
\beq
\frac{\dm^2 x^{\mu}}{\dm \tau^2} = \frac{\dm u^{\mu}}{\dm \tau} = f^{\mu}(x^{\nu}).
\eeq
Wie vorhin erwähnt unterscheiden sich die verschiedenen Verfahren durch die Art und Weise der Diskretisierung der Differentialoperatoren.
Beim Leap-Frog-Verfahren wählt man
\beq
\bal
\frac{x^{\mu}_{i+1} - x^{\mu}_i}{h} &= u^{\mu}_{i+\frac{1}{2}}\\
\frac{u^{\mu}_{i+\frac{1}{2}} - u^{\mu}_{i-\frac{1}{2}}}{h} &= f^{\mu}(x^{\nu}_i).
\eal
\eeq
Auflösen nach dem neuen Zeitschritt ergibt dann
\beq
\bal
x^{\mu}_{i+1} &= x^{\mu}_i + h u^{\mu}_{i+\frac{1}{2}}\\
u^{\mu}_{i+\frac{1}{2}} &= u^{\mu}_{i-\frac{1}{2}} + h f^{\mu}(x^{\nu}_i).
\eal
\eeq
\noindent
Wie man sieht, werden Ort und Geschwindigkeit zu unterschiedlichen Zeitpunkten berechnet. Sie sind zeitlich um $h = \frac{1}{2}$ gegeneinander versetzt. 
\subsection{Boris-Pusher}
\subsection{Vay-Pusher}
\subsection{Interpolation der Trajektorien}
Die vorangegangenen vorgestellten Verfahren berechnen die Teilchentrajektorien nur an diskreten Stellen $x_i^{\mu}(\tau)$. Um die Liénard-Wiechert Felder nach Gleichung \eqref{eqn: LW} an einem Beobachtungspunkt zu berechnen, wird jedoch der Schnittpunkt der Trajektorie mit dem Rückwärtslichtkegel des jeweiligen Beobachtungspunktes benötigt. Da in den meisten Fällen 
die berechneten Punkte der Trajektorie nicht direkt auf dem Lichtkegel liegen werden, benötigen wir ein Verfahren, um den genauen Schnittpunkt zu berechnen. \\
Die einfachste Lösung ist eine lineare Interpolation zwischen dem letzten Punkt außerhalb und des ersten Punktes innerhalb des Lichtkegels. Bild \ref{fig: Interpolation} veranschaulicht die Situation.\\ %MISSING: FIGURE
Sei dazu $x_j^{\mu} \in \mathbb{R}^{3+1}$ der letzte Punkt außerhalb und $x_{j+1}^{\mu} \in \mathbb{R}^{3+1}$ der erste Punkt innerhalb des Lichtkegels. Ferner sei $x_{c}^{\mu} \in \mathbb{R}^{3+1}$ der gesuchte Schnittpunkt, dann gilt:
\beq
\label{eqn: linInt}
x_c^{\mu} = x_j^{\mu} + \lambda ~\left(x_{j+1}^{\mu} - x_j^{\mu}\right),
\eeq
wobei $\lambda \in [0,1]$. Aufgrund der endlichen Ausbreitungsgeschwindigkeit des Lichtes, muss der Punkt $x_c^{\mu}$ Bedingung \eqref{eqn: tret} erfüllen 
\beq
\label{eqn: constraint}
\left| \vec{x}_o(t) - \vec{x}_c(t_{ret})\right| = c~(t - t_{ret}) \Longleftrightarrow (x_o - x_c)_{\mu} (x_o - x_c)^{\mu} = 0.
\eeq
Dabei bezeichnet $x_o^{\mu} \in \mathbb{R}^{3+1}$ den Beobachtungspunkt, an dem die Felder berechnet werden sollen. Zu beachten ist, dass auf der linken Seite des Äquivalenzzeichens ausschließlich die räumlichen Komponenten der respektiven Vierervektoren stehen. \\
Einsetzen von \eqref{eqn: linInt} in \eqref{eqn: constraint} liefert 
\beq
\label{eqn: quadEq}
\lambda^2 (x_{j+1} - x_j)_{\mu}(x_{j+1} - x_j)^{\mu} + \lambda~2(x_{j+1} - x_j)_{\mu}(x_j - x_o)^{\mu} + (x_j)_{\mu}(x_j)^{\mu} + (x_o)_{\mu}(x_o)^{\mu} - 2(x_j)_{\mu}(x_o)^{\mu}  = 0.
\eeq
Wir definieren
\beq
\bal
a &\coloneqq (x_{j+1} - x_j)_{\mu}(x_{j+1} - x_j)^{\mu}\\
b &\coloneqq 2(x_{j+1} - x_j)_{\mu}(x_j - x_o)^{\mu} \\
c &\coloneqq (x_j)_{\mu}(x_j)^{\mu} + (x_o)_{\mu}(x_o)^{\mu} - 2(x_j)_{\mu}(x_o)^{\mu}. \nn
\eal
\eeq
Die quadratische Gleichung \eqref{eqn: quadEq} in $\lambda$ hat im allgemeinen zwei Lösungen
\beq
\lambda_{1/2} = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}. \nn
\eeq
Eine Lösung beschreibt den Schnittpunkt mit dem Rückwärtslichtkegel, die andere den mit dem Vorwärtslichtkegel. Da $\lambda \in [0,1]$, interessieren wir uns nur für die größere der beiden Lösungen
\beq
\lambda_{1/2} = \frac{-b + \sqrt{b^2 - 4ac}}{2a}. \nn
\eeq
Einsetzen von $\lambda$ in \eqref{eqn: linInt} liefert den gewünschten Schnittpunkt. 
\section{Hybride Felder}
\subsection{Maxwell-Gleichungen}
\subsection{Maxwell-Solver}
\subsection{Nah-und Fernfelder}


%============================= Abbildungsverzeichnis ===========================
\listoffigures

%======================== Literaturverzeichnis ========================

\bibliography{reference}{}
\bibliographystyle{plain}

\end{document}











