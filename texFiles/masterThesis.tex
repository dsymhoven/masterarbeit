\documentclass[
a4paper,					% alle weiteren Papierformat einstellbar
%landscape,					% Querformat
11pt,						% SchriftgrößŸe (12pt, 11pt (Standard))
BCOR0.8cm,					% Bindekorrektur, bspw. 1 cm
%DIVcalc,					% führt die Satzspiegelberechnung neu aus
twoside,					% einseitiges Layout
%twocolumn,					% zweispaltiger Satz
%openany,					% Kapitel können auch auf linken Seiten beginnen
%halfparskip*,				% Absatzformatierung s. scrguide 3.1
%notitlepage,				% in-page-Titel, keine eigene Titelseite
%chapterprefix,				% vor Kapitelüberschrift wird "Kapitel Nummer" gesetzt
%appendixprefix,			% Anhang wird "Anhang" vor die Üœberschrift gesetzt 
%normalheadings,			% Üœberschriften etwas kleiner (smallheadings)
%idxtotoc,					% Index im Inhaltsverzeichnis
%liststotoc,				% Abb.- und Tab.verzeichnis im Inhalt
%bibtotoc,					% Literaturverzeichnis im Inhalt
bibliography=totoc,
%leqno,						% Nummerierung von Gleichungen links
%fleqn,						% Ausgabe von Gleichungen linksbündig
%draft						% Überlangen Zeilen in Ausgabe gekennzeichnet
]{scrreprt}

% ============================ Packages ============================ 

\usepackage[inner=3.0cm,outer=2.5cm,top=1.5cm,bottom=1.5cm,includeheadfoot]{geometry}
									% Einstellungen der Seitenränder

\usepackage[T1]{fontenc}				% neue Rechtschreibung
\usepackage[latin1]{inputenc}		         % Umlaute ermöglichen
\usepackage[german, english]{babel}
\usepackage{fancyhdr}				% für Kopf- und FußŸzeile
\usepackage[hyperref]{xcolor}		
\definecolor{MyBlue}{RGB}{50,79,132}		% für Kopf- und Fußzeile
\usepackage[colorlinks, citecolor=MyBlue, linktocpage, linkcolor=MyBlue]{hyperref}
\usepackage{color}					% Farbe
\usepackage[pdftex]{graphicx}
\usepackage{float}
\usepackage{listings}				% Programm-Code
\usepackage{longtable}				% Tabellen über mehrere Seiten
\usepackage{siunitx}				% Einheiten nach SI-Norm
\usepackage{listings}                                    % Verwendung von Matlab-Code
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage[tight]{subfigure}
\usepackage{empheq}
\usepackage{overcite}
\usepackage{url}
\usepackage{framed}
\usepackage{pdfpages}
\usepackage[compact]{titlesec}
% ============================ Kopf- und Fußzeile ==========================

\pagestyle{fancy}
\fancyhf{}

\fancyhead[CO,CE]{\scshape\leftmark}	% Kopfzeile links [L], mitte [C], rechts [R]
\fancyfoot[RO,LE]{\thepage}				% Fußzeile
\renewcommand{\headrulewidth}{0.5pt}	% Linie oben
\renewcommand{\footrulewidth}{0pt}		% Linie unten
\pagenumbering{roman}

%============================ new Definitions ============================
\include{definitions}
\include{newChapterDefinition}
% =============================Titelseite ==================================

\begin{document}

\pagenumbering{roman}
\include{titlepage}

%================================= ABSTRACT==============================
\include{abstract}

%================================= SYMBOLE UND KONTANTEN ================
\include{symbols}

%================================= Inhaltsverzeichnis ==========================
\tableofcontents

%============================ Beginn Textseiten ================================
\pagenumbering{arabic}



%================================= Bildvorlage ====================================

%Code für Bildumgebung
%\begin{figure}[H]
	%\centering
	%	\includegraphics[width=0.50\textwidth]{Destruktive_Interferenz.jpg} %Bild 1
	%\caption[Destruktive Interferenz]{Destruktive Interferenz \cite{[Wiki12]}}
	%\label{fig:Interferenzfilterr}
%\end{figure}

%===========================================================================


%======================== EINLEITUNG ========================
%===========================================================
\chapter{Introduction}
Now it's going loose ...  \cite{Allen}

\chapter{Fundamentals}
\section{Liénard-Wiechert Potentials}
\label{sec: lw-potentials}
\section{Numerics}
\noindent
The following section deals with the numeric aspects of this thesis. We explain the underlying equation of motions and their history. After that, we go into several methods with which we can solve differential equations. Over the course of the last decades numerous methods were invented each of which has its own strength and weaknesses. 
Some of them are very easy to implement, which in turn usually leads to unprecise results. Others are quite complicated and sophisticated to implement, but very accurate.
Therefore one should always consider which method is best for the problem and what it is one want to to achieve.\\
Following this, we also want to define and calculate the numerical complexity of some chosen algorithms. 

\subsection{Equations of motion}
As we know from mechanics the dynamic of a particle is determined by the forces acting on it. In our case there is a force due to electro-magnetic fields. That can be external fields, but also fields due to moving particles, as we explained in section \ref{sec: lw-potentials}.\\
The dynamics of our system is described by the \textit{Lorentz-Newton} equation
\beq
\label{eqn: Lorentz-Newton}
\bal
\frac{\dm x^{\mu}}{\dm \tau} &= u^{\mu}\\
\frac{\dm u^{\mu}}{\dm \tau} &= F^{\mu}_{~\nu}~u^{\nu} + g^{\mu},
\eal
\eeq
which derivation is quite longish, why we want to refer to literature. \\%MISSING: cite
The term $F^{\mu}_{~\nu}$ describes the electromagnetic field strength tensor
\beq
F^{\mu}_{~\nu} = 
\begin{pmatrix}
0 & E_x & E_y & E_z \\
E_x & 0 & B_z & -B_y \\
E_y & -B_z & 0 & B_x \\
E_z & B_y & -B_x & 0
\end{pmatrix}
.
\eeq
The damping term $g^{\mu}$ considers the fact that charged particles radiate fields when they are moving which leads to a loss in their kinetic energy. Within the context of classical electrodynamics Max \textit{Abraham} and Hendrick \textit{Lorentz} discussed radiation damping in their same-named equation first.
In 1938 \textit{Dirac} generalized the equation whilst taking special relativity into account. \\% MISSING: Cites
% MISSING: Details. Historisches. Abraham, Lorentz, Dirac Landau Lifschitz Gleichung usw.
We now want to deal with how to solve the Lorentz-Newton equation \eqref{eqn: Lorentz-Newton} numerically.

\subsection{Euler-Scheme}
The most simple method is the explicit \textit{Euler}-Method. It's easy to implement but not very accurate, as we shall see later. But before we go into the details of the explicit Euler-Scheme we need to address some prerequisites all following methods will have in common. \\
Starting point will always be a first order system of the kind
\beq
\label{eqn: Euler}
\bal
\frac{\dm x^{\mu}}{\dm \tau} &= u^{\mu}\\
\frac{\dm u^{\mu}}{\dm \tau} &= f^{\mu}(x^{\nu},u^{\nu})\\
x^{\mu}(\tau_0) &= x^{\mu}_0\\
u^{\mu}(\tau_0) &= u^{\mu}_0.
\eal
\eeq
Systems of higher order can always be reduced to a first order system. \\
In order to solve the equation of motion numerically the domain needs to be discretized. Therefore we divide the time interval into N equidistant partial intervals $h$, by defining
\beq
h \coloneqq \Delta \tau = \tau_{i+1} - \tau_i. \nn
\eeq
The idea is to calculate each point along the trajectory $x^{\mu}_i = x^{\mu}(\tau_i)$ iteratively, starting from the initial values $x^{\mu}_0$ and $u^{\mu}_0$.
But to calculate these points all differential operators in  \eqref{eqn: Euler} need to be discretized as well. That is where all methods differ. Each method has its own way to discretize the differential operators.\\
The basis of the Euler-Scheme is a first order Taylor expansion of the integration variable $x^{\mu}$ in $\tau$ around $\tau_i$
\beq
\label{eqn: Taylor}
x^{\mu}(\tau_{i+1}) =  x^{\mu}(\tau_i) + \frac{\dm x^{\mu}}{\dm \tau} \Big |_{\tau=\tau_i} \underbrace{(\tau_{i+1} - \tau_i)}_{=h} + \mathcal{O}(h^2).
\eeq
Analogously for $u^{\mu}$ and solving for  $\frac{\dm x^{\mu}}{\dm \tau}$ and $\frac{\dm u^{\mu}}{\dm \tau}$ respectively yields
\beq
\bal
\frac{x^{\mu}_{i+1} - x^{\mu}_i}{h} &= u^{\mu}_i\\
\frac{u^{\mu}_{i+1} - u^{\mu}_i}{h} &= f^{\mu}(x^{\nu}_i,u^{\nu}_i).
\eal
\eeq
This way of discretizing allows a very easy calculation of $x^{\mu}_i$ according to
 \beq
\bal
x^{\mu}_{i+1} &= x^{\mu}_i + h~u^{\mu}_i\\
u^{\mu}_{i+1} &= u^{\mu}_i + h~f^{\mu}(x^{\nu}_i,u^{\nu}_i).
\eal
\eeq
In order for us to calculate the goodness of this approximation we need to introduce the \textit{Procedural Error} and the \textit{Order of Consistency} \cite{NumerikSkript}.\\
\subsubsection{Procedural Error  and Order of Consistency}
\newtheorem{env_definition}{Definition}[section]
\begin{env_definition}[Procedural Error  and Order of Consistency]
\label{def: Procedural Error}
Let $I \subseteq \mathbb{R}$ be a interval, $f : I \times \mathbb{R}^d \to \mathbb{R}^d$, $y : I \to \mathbb{R}^{d}$ a solution of the initial value problem
\beq
\bal
\frac{\dm}{\dm \tau}y(\tau) &= f(\tau,y(\tau)),\\
y(\tau_0) &= y_0. 
\eal
\eeq
\begin{description}
\item[(a)] The term 
\beq
\eta(\tau,h) \coloneqq y(\tau) + h f(\tau, y(\tau)) - y(\tau+h)\quad \text{for}~\tau \in I,~ 0 < h \le b - \tau
\eeq
is called local Procedural Error of the One-Step-Scheme at $\tau$ for the increment h.
\item[(b)] The One-Step-Scheme has an Order of Consistency $p \ge 1$, if the local Procedural Error fulfils
\beq
||\eta(\tau,h) || \le Ch^{p+1}\quad \text{for}~\tau \in I,~ 0 < h \le b - \tau,
\eeq 
with a constant $C\ge 0$, which is independent of $\tau$ and $h$.
\end{description}
\end{env_definition}
Descriptively the Procedural Error is the difference between the exact solution $y(\tau+h)$ and the result, which we get from the One-Step-Scheme starting from the exact solution at the earlier time step $y(\tau)$.
Figure \ref{fig: Procedural Error} illustrates the situation.
\begin{figure}[H]
	\centering
		\includegraphics[width=0.50\textwidth]{Pictures/Verfahrensfehler.png} %Bild 1
	\caption[Procedural Error]{Illustration of the Procedural Errors of an One-Step-Scheme.~ \cite{NumerikSkript}}
	\label{fig: Procedural Error}
\end{figure}
\noindent
We now want to use the definitions \ref{def: Procedural Error} to calculate the Order of Consistency of the Euler-Scheme.\\
Starting point is the system \eqref{eqn: Lorentz-Newton}. Thereby we focus on the equation for $u^{\mu}$, since $x^{\mu}$ can be easily integrated from $u^{\mu}$.
Following Definition \ref{def: Procedural Error} we have
\beq
y = u^{\mu}. \nn \\
\eeq
We get
\beq
\label{eqn: eta u}
\eta(\tau, h) = u^{\mu}(\tau_i) + h f^{\mu}(x^{\nu}, u^{\nu}) - u^{\mu}(\tau_{i+1}).
\eeq
The last term can be calculated with a Taylor-expansion analogously to \eqref{eqn: Taylor}.
\beq
\label{eqn: Taylor u}
u^{\mu}(\tau_{i+1}) =  u^{\mu}(\tau_i) + h~\frac{\dm u^{\mu}}{\dm \tau} \Big |_{s=\tau_i}  + h^2~\frac{\dm^2 u^{\mu}}{\dm \tau^2} \Big |_{s=\tau_i}.
\eeq
Plugging in \eqref{eqn: Taylor u} in \eqref{eqn: eta u} yields
\beq
\bal
\eta(\tau, h) &= u^{\mu}(\tau_i) + h\frac{\dm u^{\mu}}{\dm \tau}  - u^{\mu}(\tau_{i+1}) \\
\stackrel{ \eqref{eqn: Taylor u}}{\Longrightarrow}\eta(\tau, h) &= u^{\mu}(\tau_i) + h\frac{\dm u^{\mu}}{\dm \tau}  - u^{\mu}(\tau_i) - h\frac{\dm u^{\mu}}{\dm \tau} - h^2\frac{\dm^2 u^{\mu}}{\dm \tau^2}\\
\Longleftrightarrow\eta(\tau, h) &= \frac{\dm^2 u^{\mu}}{\dm \tau^2}~h^2 ,
\eal
\eeq
since $\frac{\dm u^{\mu}}{\dm \tau} = f^{\mu}(x^{\nu}, u^{\nu})$ holds for the Euler-Scheme. Thus
\beq
|\eta(\tau, h)| \le C h^2 \quad \text{with}~C \coloneqq \frac{1}{2} \max_{\tau \in \mathcal{D}(u^{\mu})}\left| \frac{\dm^2 u^{\mu}}{\dm \tau^2}\right|.
\eeq
$\mathcal{D}(u^{\mu})$ denotes the domain of $u^{\mu}$. Therefore, the Euler-Scheme has an Order of Consistency of one.

\subsection{Leap-Frog-Scheme}
A definitely better method is the so called \textit{Leap-Frog}-Scheme. One can easily proof that it has an Order of Consistency of two. \\
In contrast to the explicit Euler-Scheme this method has several advantages. For one it is time reversible, i.e. it is possible to reach any previous point in time from every point later in the trajectory. On the other hand the Leap-Frog-Scheme is symplectic, meaning it conserves the phase space volume from which energy and momentum conservation follows. \\
However, one disadvantage is that it's only suited for systems in which the acting force exclusively depends on the current position, but not on the velocity of the particle. This would lead to an implicit equation system which is numerically way more expensive to solve. \\
Thus the differential equation should be of the form
\beq
\frac{\dm^2 x^{\mu}}{\dm \tau^2} = \frac{\dm u^{\mu}}{\dm \tau} = f^{\mu}(x^{\nu}).
\eeq
As we already mentioned, the various methods discretize the differential operators differently
The Leap-Frog-Scheme uses
\beq
\bal
\frac{x^{\mu}_{i+1} - x^{\mu}_i}{h} &= u^{\mu}_{i+\frac{1}{2}}\\
\frac{u^{\mu}_{i+\frac{1}{2}} - u^{\mu}_{i-\frac{1}{2}}}{h} &= f^{\mu}(x^{\nu}_i).
\eal
\eeq
Solving for the new time step yields
\beq
\bal
x^{\mu}_{i+1} &= x^{\mu}_i + h u^{\mu}_{i+\frac{1}{2}}\\
u^{\mu}_{i+\frac{1}{2}} &= u^{\mu}_{i-\frac{1}{2}} + h f^{\mu}(x^{\nu}_i).
\eal
\eeq
\noindent
As we can see, position and velocity are calculated at different times. They are shifted against each other in time by $h = \frac{1}{2}$. \\
But what if we have a system in which the force depends on the velocity ? Are we stuck with expensive implicit methods ? Fortunately not. We can use the \textit{Boris} - Method.
\subsection{Boris-Method}
This method was invented in 1970 by J.P. Boris \cite{boris} and is the standard method for pushing particles in plasma simulations today. We want to solve the Lorentz-Newton equation
\beq
\label{eqn: LorentzNewton}
\bal
\frac{v_{i+\frac{1}{2}} - v_{i - \frac{1}{2}}}{h} &= \frac{q}{m}\left(\vec{E} + \frac{v_{i+\frac{1}{2}} + v_{i - \frac{1}{2}}}{2} \times \vec{B}\right)
\eal
\eeq
Boris noticed, that upon defining
\beq
\label{eqn:vMinusAndPlus}
\bal
\vec{v}_{-} &\coloneqq v_{i - \frac{1}{2}} + \frac{h}{2}\frac{q \vec{E}}{m}\quad\text{and} \\
\vec{v}_{+} &\coloneqq v_{i + \frac{1}{2}} + \frac{h}{2}\frac{q \vec{E}}{m},
\eal
\eeq
one can eliminate the electric field. Plugging in \eqref{eqn:vMinusAndPlus} into \eqref{eqn: LorentzNewton} yields
\beq
\bal
\frac{\vec{v}_{+} - \vec{v}_{-}}{h} = \frac{q}{m} (\vec{v}_{+} + \vec{v}_{-}) \times \vec{B}.
\eal
\eeq
Following the geometrical analysis in ~\cite{Birdsall} we find %MISSING:PIctures from Birdsall and rest of explaination
\subsection{Vay-Pusher}
\subsection{Interpolation of Trajectories}
The previously presented methods calculate the particle trajectory solely at discrete points in time $x_i^{\mu}(\tau)$. Calculating Liénard-Wiechert fields according to equation \eqref{eqn: LW} however, requires the intersection point of the trajectory with the backward lightcone of the observation point. 
In most cases the calculated points of the trajectory are not lying directly on the lightcone, so we need a procedure to calculate the intersection point exactly.\\
The simplest solution is a linear interpolation between the last point outside and the first point inside the lightcone. Figure \ref{fig: Interpolation} illustrates the situation.\\ %MISSING: FIGURE
Thereto let $x_j^{\mu} \in \mathbb{R}^{3+1}$ be the last point outside and $x_{j+1}^{\mu} \in \mathbb{R}^{3+1}$ the first point inside the lightcone. Further let $x_{c}^{\mu} \in \mathbb{R}^{3+1}$ be the intersection point of interest then we get
\beq
\label{eqn: linInt}
x_c^{\mu} = x_j^{\mu} + \lambda ~\left(x_{j+1}^{\mu} - x_j^{\mu}\right),
\eeq
where $\lambda \in [0,1]$. Due to the finite speed of light the intersection point $x_c^{\mu}$ needs to fulfil equation \eqref{eqn: tret} 
\beq
\label{eqn: constraint}
\left| \vec{x}_o(t) - \vec{x}_c(t_{ret})\right| = c~(t - t_{ret}) \Longleftrightarrow (x_o - x_c)_{\mu} (x_o - x_c)^{\mu} = 0.
\eeq
Thereby $x_o^{\mu} \in \mathbb{R}^{3+1}$ denotes the observation point where the fields shall be calculated. Note, that on the left hand side of \eqref{eqn: constraint} only spatial components of the respective four vectors are used. \\
Plugging in \eqref{eqn: linInt} in \eqref{eqn: constraint} yields
\beq
\label{eqn: quadEq}
\lambda^2 (x_{j+1} - x_j)_{\mu}(x_{j+1} - x_j)^{\mu} + \lambda~2(x_{j+1} - x_j)_{\mu}(x_j - x_o)^{\mu} + (x_j)_{\mu}(x_j)^{\mu} + (x_o)_{\mu}(x_o)^{\mu} - 2(x_j)_{\mu}(x_o)^{\mu}  = 0.
\eeq
We define
\beq
\bal
a &\coloneqq (x_{j+1} - x_j)_{\mu}(x_{j+1} - x_j)^{\mu}\\
b &\coloneqq 2(x_{j+1} - x_j)_{\mu}(x_j - x_o)^{\mu} \\
c &\coloneqq (x_j)_{\mu}(x_j)^{\mu} + (x_o)_{\mu}(x_o)^{\mu} - 2(x_j)_{\mu}(x_o)^{\mu}. \nn
\eal
\eeq
In general the quadratic equation \eqref{eqn: quadEq} in $\lambda$ has two solutions
\beq
\lambda_{1/2} = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}. \nn
\eeq
One denotes the intersection point with the backward lightcone, the other one with the forward lightcone. Since  $\lambda \in [0,1]$ we are only interested in the larger one. 
\beq
\lambda_{1/2} = \frac{-b + \sqrt{b^2 - 4ac}}{2a}. \nn
\eeq
Plugging in $\lambda$ in \eqref{eqn: linInt} gives the desired intersection point.
\section{Hybrid Fields}
\subsection{Maxwell-Equations}
\subsection{Maxwell-Solver}
\subsection{Near-and Farfields}


%============================= Abbildungsverzeichnis ===========================
\listoffigures

%======================== Literaturverzeichnis ========================

\bibliography{reference}{}
\bibliographystyle{plain}

%================================= ERKLÄRUNG=============================
\include{declaration}


\end{document}











