<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: lwFields.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">lwFields.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="lw_fields_8h_source.html">lwFields.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="calculations_8h_source.html">calculations.h</a>&quot;</code><br />
<code>#include &quot;string.h&quot;</code><br />
<code>#include &quot;math.h&quot;</code><br />
<code>#include &quot;stdlib.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for lwFields.c:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c__incl.png" border="0" usemap="#lw_fields_8c" alt=""/></div>
<map name="lw_fields_8c" id="lw_fields_8c">
<area shape="rect" id="node2" href="lw_fields_8h.html" title="lwFields.h" alt="" coords="47,80,128,107"/>
<area shape="rect" id="node7" href="calculations_8h.html" title="calculations.h" alt="" coords="159,155,261,181"/>
<area shape="rect" id="node4" href="grid_8h.html" title="grid.h" alt="" coords="27,155,83,181"/>
<area shape="rect" id="node6" href="particle_8h.html" title="particle.h" alt="" coords="76,229,152,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a476da358b14047cff9fbfd11e46bb275"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a476da358b14047cff9fbfd11e46bb275">pushEField</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, double t, double dt)</td></tr>
<tr class="memdesc:a476da358b14047cff9fbfd11e46bb275"><td class="mdescLeft">&#160;</td><td class="mdescRight">pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally pushes E field at box borders.  <a href="#a476da358b14047cff9fbfd11e46bb275">More...</a><br /></td></tr>
<tr class="separator:a476da358b14047cff9fbfd11e46bb275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af45e2e7d9e6c006510383e5295410fa8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#af45e2e7d9e6c006510383e5295410fa8">pushHField</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, double t, double dt)</td></tr>
<tr class="memdesc:af45e2e7d9e6c006510383e5295410fa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally pushes H field at box borders.  <a href="#af45e2e7d9e6c006510383e5295410fa8">More...</a><br /></td></tr>
<tr class="separator:af45e2e7d9e6c006510383e5295410fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472e4ed96bca43242a8b4e94b15991d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a472e4ed96bca43242a8b4e94b15991d1">pushEFieldInsideBoxes</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, double dt)</td></tr>
<tr class="memdesc:a472e4ed96bca43242a8b4e94b15991d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maxwell Pusher for EField inside Boxes. This method is used for the hybrid field method.  <a href="#a472e4ed96bca43242a8b4e94b15991d1">More...</a><br /></td></tr>
<tr class="separator:a472e4ed96bca43242a8b4e94b15991d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4138b9989d8810aa35e0e6c1e0ea4fe0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a4138b9989d8810aa35e0e6c1e0ea4fe0">pushHFieldInsideBoxes</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, double dt)</td></tr>
<tr class="memdesc:a4138b9989d8810aa35e0e6c1e0ea4fe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maxwell Pusher for HField inside Boxes. This method is used for the hybrid field method.  <a href="#a4138b9989d8810aa35e0e6c1e0ea4fe0">More...</a><br /></td></tr>
<tr class="separator:a4138b9989d8810aa35e0e6c1e0ea4fe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a764fbbefccc598e48988dab3371f808b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a764fbbefccc598e48988dab3371f808b">setHFieldOnBorders</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>)</td></tr>
<tr class="memdesc:a764fbbefccc598e48988dab3371f808b"><td class="mdescLeft">&#160;</td><td class="mdescRight">this methods loops through all boxes and stores all values of H in the plane left, infront and below of the current box. As can be seen from the Yee Scheme only Hy and Hz are needed from the left plane. Hz and Hx are needed from the plane infront and Hy and Hx are needed from the plane below. If the current box is a box where to the left does not exist (ib = 0) then the respective values for H are set to 0.  <a href="#a764fbbefccc598e48988dab3371f808b">More...</a><br /></td></tr>
<tr class="separator:a764fbbefccc598e48988dab3371f808b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46580d5ee2d7d0ae9277aee52395f565"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a46580d5ee2d7d0ae9277aee52395f565">setEFieldOnBorders</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>)</td></tr>
<tr class="memdesc:a46580d5ee2d7d0ae9277aee52395f565"><td class="mdescLeft">&#160;</td><td class="mdescRight">this methods loops through all boxes and stores all values of E in the plane right, behind and above of the current box. As can be seen from the Yee Scheme only Ey and Ez are needed from the right plane. Ez and Ex are needed from the plane behind and Ey and Ex are needed from the plane above. If the current box is a box where the plane to the right does not exist (ib = numberOfBoxesInX) then the respective values for E are set to 0.  <a href="#a46580d5ee2d7d0ae9277aee52395f565">More...</a><br /></td></tr>
<tr class="separator:a46580d5ee2d7d0ae9277aee52395f565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8dbdc1271ca06b419d54acc97bcd8e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#ad8dbdc1271ca06b419d54acc97bcd8e2">adjustHFields</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const double t)</td></tr>
<tr class="memdesc:ad8dbdc1271ca06b419d54acc97bcd8e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in "adjustHyz_im1()", "adjustHxz_jm1()" and "adjustHxy_km1()" method.  <a href="#ad8dbdc1271ca06b419d54acc97bcd8e2">More...</a><br /></td></tr>
<tr class="separator:ad8dbdc1271ca06b419d54acc97bcd8e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8ac4e291df72434f59801ae4431349"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#adc8ac4e291df72434f59801ae4431349">adjustHyz_im1</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const int boxIndex, const int ib, const int jb, const int kb, const double t)</td></tr>
<tr class="memdesc:adc8ac4e291df72434f59801ae4431349"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method adjusts the H values on the left and right side border of the near field.  <a href="#adc8ac4e291df72434f59801ae4431349">More...</a><br /></td></tr>
<tr class="separator:adc8ac4e291df72434f59801ae4431349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5719955e373b30ae2de7e6b91829eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a3e5719955e373b30ae2de7e6b91829eb">adjustHxz_jm1</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const int boxIndex, const int ib, const int jb, const int kb, const double t)</td></tr>
<tr class="memdesc:a3e5719955e373b30ae2de7e6b91829eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method adjusts the H values infront and on the back side border of the near field.  <a href="#a3e5719955e373b30ae2de7e6b91829eb">More...</a><br /></td></tr>
<tr class="separator:a3e5719955e373b30ae2de7e6b91829eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc1a6143e678da91f19584c826428cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#aefc1a6143e678da91f19584c826428cd">adjustHxy_km1</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const int boxIndex, const int ib, const int jb, const int kb, const double t)</td></tr>
<tr class="memdesc:aefc1a6143e678da91f19584c826428cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method adjusts the H values on the top and bottom side border of the near field.  <a href="#aefc1a6143e678da91f19584c826428cd">More...</a><br /></td></tr>
<tr class="separator:aefc1a6143e678da91f19584c826428cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7a60b207d6d07de2f2f9ed4f0507c50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#ab7a60b207d6d07de2f2f9ed4f0507c50">adjustEFields</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const double t)</td></tr>
<tr class="memdesc:ab7a60b207d6d07de2f2f9ed4f0507c50"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in "adjustEyz_ip1()", "adjustExz_jp1()" and "adjustExy_kp1()" method.  <a href="#ab7a60b207d6d07de2f2f9ed4f0507c50">More...</a><br /></td></tr>
<tr class="separator:ab7a60b207d6d07de2f2f9ed4f0507c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae05dc350695f83d10835578077f7ce61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#ae05dc350695f83d10835578077f7ce61">adjustEyz_ip1</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const int boxIndex, const int ib, const int jb, const int kb, const double t)</td></tr>
<tr class="memdesc:ae05dc350695f83d10835578077f7ce61"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method adjusts the E values on the left and right side border of the near field.  <a href="#ae05dc350695f83d10835578077f7ce61">More...</a><br /></td></tr>
<tr class="separator:ae05dc350695f83d10835578077f7ce61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac917d3c7ad39bc896aa96ce84ad0d71c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#ac917d3c7ad39bc896aa96ce84ad0d71c">adjustExz_jp1</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const int boxIndex, const int ib, const int jb, const int kb, const double t)</td></tr>
<tr class="memdesc:ac917d3c7ad39bc896aa96ce84ad0d71c"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method adjusts the E values infront and on the back side border of the near field.  <a href="#ac917d3c7ad39bc896aa96ce84ad0d71c">More...</a><br /></td></tr>
<tr class="separator:ac917d3c7ad39bc896aa96ce84ad0d71c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb9e81297ffee9719f4267301baa19b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#aceb9e81297ffee9719f4267301baa19b">adjustExy_kp1</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *Particles, int numberOfParticles, const int boxIndex, const int ib, const int jb, const int kb, const double t)</td></tr>
<tr class="memdesc:aceb9e81297ffee9719f4267301baa19b"><td class="mdescLeft">&#160;</td><td class="mdescRight">this method adjusts the E values at top and bottom side border of the near field.  <a href="#aceb9e81297ffee9719f4267301baa19b">More...</a><br /></td></tr>
<tr class="separator:aceb9e81297ffee9719f4267301baa19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8542932ce0ccd85e67cd10d0a0ff81eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a8542932ce0ccd85e67cd10d0a0ff81eb">pushEFieldAtBorders</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, double dt)</td></tr>
<tr class="memdesc:a8542932ce0ccd85e67cd10d0a0ff81eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maxwell Pusher for EField at box borders. This method is used for the hybrid field method.  <a href="#a8542932ce0ccd85e67cd10d0a0ff81eb">More...</a><br /></td></tr>
<tr class="separator:a8542932ce0ccd85e67cd10d0a0ff81eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76bc3c422d73fce2c5c4ac84f8e5d6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#ae76bc3c422d73fce2c5c4ac84f8e5d6e">pushHFieldAtBorders</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, double dt)</td></tr>
<tr class="memdesc:ae76bc3c422d73fce2c5c4ac84f8e5d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maxwell Pusher for HField at box borders. This method is used for the hybrid field method.  <a href="#ae76bc3c422d73fce2c5c4ac84f8e5d6e">More...</a><br /></td></tr>
<tr class="separator:ae76bc3c422d73fce2c5c4ac84f8e5d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f39870c725f9dd68cef0f8d06a481e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a02f39870c725f9dd68cef0f8d06a481e">writeFieldsToFile</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, char *filename, int index, int planeForPlotting, bool plotE, bool plotB)</td></tr>
<tr class="memdesc:a02f39870c725f9dd68cef0f8d06a481e"><td class="mdescLeft">&#160;</td><td class="mdescRight">loops through the entire E and B array and writes |B|^2 and |E|^2 to seperate files. File is structured similiar to the grid.  <a href="#a02f39870c725f9dd68cef0f8d06a481e">More...</a><br /></td></tr>
<tr class="separator:a02f39870c725f9dd68cef0f8d06a481e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c9fdb75dd81fd9029d1a65c4d5a567"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a38c9fdb75dd81fd9029d1a65c4d5a567">writeFieldsFromCompleteGridToFile</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>)</td></tr>
<tr class="memdesc:a38c9fdb75dd81fd9029d1a65c4d5a567"><td class="mdescLeft">&#160;</td><td class="mdescRight">loops through the entire grid and writes respective E and B values to E_initalFields.txt and H_initialFields.txt respectively.  <a href="#a38c9fdb75dd81fd9029d1a65c4d5a567">More...</a><br /></td></tr>
<tr class="separator:a38c9fdb75dd81fd9029d1a65c4d5a567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e3c429ce6db01564dba954fe965a78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a31e3c429ce6db01564dba954fe965a78">addLWFieldsInBox</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *<a class="el" href="struct_particle.html">Particle</a>, int boxIndex, double t)</td></tr>
<tr class="memdesc:a31e3c429ce6db01564dba954fe965a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">adds LW fields in box specified by input parameter "boxIndex"  <a href="#a31e3c429ce6db01564dba954fe965a78">More...</a><br /></td></tr>
<tr class="separator:a31e3c429ce6db01564dba954fe965a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a296507eaeaf163c36b80660b879cd330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a296507eaeaf163c36b80660b879cd330">subLWFieldsInBox</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *<a class="el" href="struct_particle.html">Particle</a>, int boxIndex, double t)</td></tr>
<tr class="memdesc:a296507eaeaf163c36b80660b879cd330"><td class="mdescLeft">&#160;</td><td class="mdescRight">subtracts LW fields in box specified by input parameter "boxIndex"  <a href="#a296507eaeaf163c36b80660b879cd330">More...</a><br /></td></tr>
<tr class="separator:a296507eaeaf163c36b80660b879cd330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd066409e3d31d783b6695e00a001d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7">addLWField</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *<a class="el" href="struct_particle.html">Particle</a>, double *destination, double xObserver[4], int component)</td></tr>
<tr class="memdesc:accd066409e3d31d783b6695e00a001d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">adds LW fields at grid point with index "gridIndexInBox". Each point on the grid is considered to be the observation point, where the zeroth component is the current simulation time and also the time at which we want to calculate the fields. Therefore loop through the particle xhistory vector up to the current simulation time and search for the pair of positions which fulfil the condition that the old position is inside and the new position is outside the backward lightcone of the observation point. Once that pair of positions is found the rest of the xHistory vector can be skipped because all following points will be outside as well.  <a href="#accd066409e3d31d783b6695e00a001d7">More...</a><br /></td></tr>
<tr class="separator:accd066409e3d31d783b6695e00a001d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96197f1e2e5444c3f9f16b528a453f2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f">subLWField</a> (<a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, <a class="el" href="struct_particle.html">Particle</a> *<a class="el" href="struct_particle.html">Particle</a>, double *destination, double xObserver[4], int component)</td></tr>
<tr class="memdesc:a96197f1e2e5444c3f9f16b528a453f2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">adds LW fields at grid point with index "gridIndexInBox". Each point on the grid is considered to be the observation point, where the zeroth component is the current simulation time and also the time at which we want to calculate the fields. Therefore loop through the particle xhistory vector up to the current simulation time and search for the pair of positions which fulfil the condition that the old position is inside and the new position is outside the backward lightcone of the observation point. Once that pair of positions is found the rest of the xHistory vector can be skipped because all following points will be outside as well.  <a href="#a96197f1e2e5444c3f9f16b528a453f2f">More...</a><br /></td></tr>
<tr class="separator:a96197f1e2e5444c3f9f16b528a453f2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11d47532e4411c70d5cb6adaa199e68e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a11d47532e4411c70d5cb6adaa199e68e">updateFieldsForParticlePush</a> (<a class="el" href="struct_particle.html">Particle</a> *<a class="el" href="struct_particle.html">Particle</a>, <a class="el" href="struct_grid.html">Grid</a> *<a class="el" href="struct_grid.html">Grid</a>, double Eextern[3], double Bextern[3], double E[3], double B[3])</td></tr>
<tr class="memdesc:a11d47532e4411c70d5cb6adaa199e68e"><td class="mdescLeft">&#160;</td><td class="mdescRight">in order to push the current particle properly not just the external fields but also the field contributions from other particles propagated into the near field region need to be taken into account.  <a href="#a11d47532e4411c70d5cb6adaa199e68e">More...</a><br /></td></tr>
<tr class="separator:a11d47532e4411c70d5cb6adaa199e68e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a972f4ab940a1216ead45c573af8339d0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lw_fields_8c.html#a972f4ab940a1216ead45c573af8339d0">useUPML</a> = true</td></tr>
<tr class="separator:a972f4ab940a1216ead45c573af8339d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="accd066409e3d31d783b6695e00a001d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accd066409e3d31d783b6695e00a001d7">&#9670;&nbsp;</a></span>addLWField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addLWField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xObserver</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>component</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>adds LW fields at grid point with index "gridIndexInBox". Each point on the grid is considered to be the observation point, where the zeroth component is the current simulation time and also the time at which we want to calculate the fields. Therefore loop through the particle xhistory vector up to the current simulation time and search for the pair of positions which fulfil the condition that the old position is inside and the new position is outside the backward lightcone of the observation point. Once that pair of positions is found the rest of the xHistory vector can be skipped because all following points will be outside as well. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to an instance of a <a class="el" href="struct_grid.html">Grid</a> struct. </td></tr>
    <tr><td class="paramname">xObserver</td><td>observation point at which the LW fields ahall be calculted </td></tr>
    <tr><td class="paramname">component</td><td>component in which the observation point shall be shifted. </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_particle.html">Particle</a></td><td>pointer to an instance of a <a class="el" href="struct_particle.html">Particle</a> struct </td></tr>
    <tr><td class="paramname">destination</td><td>pointer to where LW fields shall ne added. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>the Yee-scheme requires that the E and B fields are shifted against each other. Maybe the switch case is not neccessary. But I didn't tested it yet. For the staggering a xObservationCopy vector is introduced, which is used for field calculations, so that the original xObservation vector is left untouched. After staggering took place the currentHistoryLength property of <a class="el" href="struct_particle.html">Particle</a> struct is used as upper loop index. By doing this, this method (and all above the chain) can be used either within the outer simulation loop to calculate the fileds every time step (video) or afterwards to caluclate the fields just ones. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_accd066409e3d31d783b6695e00a001d7_cgraph.png" border="0" usemap="#lw_fields_8c_accd066409e3d31d783b6695e00a001d7_cgraph" alt=""/></div>
<map name="lw_fields_8c_accd066409e3d31d783b6695e00a001d7_cgraph" id="lw_fields_8c_accd066409e3d31d783b6695e00a001d7_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="157,27,341,53"/>
<area shape="rect" id="node5" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="162,81,335,108"/>
<area shape="rect" id="node8" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="197,132,300,159"/>
<area shape="rect" id="node9" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="163,183,335,225"/>
<area shape="rect" id="node10" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="187,249,310,276"/>
<area shape="rect" id="node11" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="147,300,351,327"/>
<area shape="rect" id="node3" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="632,5,751,32"/>
<area shape="rect" id="node4" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="437,27,541,53"/>
<area shape="rect" id="node6" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="399,78,579,119"/>
<area shape="rect" id="node7" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="627,85,756,112"/>
<area shape="rect" id="node12" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="439,300,539,327"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_accd066409e3d31d783b6695e00a001d7_icgraph.png" border="0" usemap="#lw_fields_8c_accd066409e3d31d783b6695e00a001d7_icgraph" alt=""/></div>
<map name="lw_fields_8c_accd066409e3d31d783b6695e00a001d7_icgraph" id="lw_fields_8c_accd066409e3d31d783b6695e00a001d7_icgraph">
<area shape="rect" id="node2" href="calculations_8h.html#a0fd8e3c4ba78390bd6a0f3245d1540a1" title="calcLWFieldsForPlane" alt="" coords="147,161,303,188"/>
<area shape="rect" id="node8" href="calculations_8h.html#a32c97a4eb1ac3f14484661bc2720ab10" title="calcLWFieldsForPlaneWith\lNearField" alt="" coords="595,49,777,90"/>
<area shape="rect" id="node14" href="lw_fields_8h.html#adc8ac4e291df72434f59801ae4431349" title="this method adjusts the H values on the left and right side border of the near field. " alt="" coords="170,212,279,239"/>
<area shape="rect" id="node18" href="lw_fields_8h.html#a3e5719955e373b30ae2de7e6b91829eb" title="this method adjusts the H values infront and on the back side border of the near field. " alt="" coords="170,263,279,289"/>
<area shape="rect" id="node19" href="lw_fields_8h.html#aefc1a6143e678da91f19584c826428cd" title="this method adjusts the H values on the top and bottom side border of the near field. " alt="" coords="168,313,281,340"/>
<area shape="rect" id="node20" href="lw_fields_8h.html#ae05dc350695f83d10835578077f7ce61" title="this method adjusts the E values on the left and right side border of the near field. " alt="" coords="172,364,277,391"/>
<area shape="rect" id="node23" href="lw_fields_8h.html#ac917d3c7ad39bc896aa96ce84ad0d71c" title="this method adjusts the E values infront and on the back side border of the near field. " alt="" coords="172,415,277,441"/>
<area shape="rect" id="node24" href="lw_fields_8h.html#aceb9e81297ffee9719f4267301baa19b" title="this method adjusts the E values at top and bottom side border of the near field. ..." alt="" coords="170,465,279,492"/>
<area shape="rect" id="node25" href="lw_fields_8h.html#a31e3c429ce6db01564dba954fe965a78" title="adds LW fields in box specified by input parameter &quot;boxIndex&quot; " alt="" coords="378,427,511,453"/>
<area shape="rect" id="node3" href="experiment_8h.html#a93af21472ce6a2cf691bb5fb9a2555b5" title="testLWFieldCalculationFor\lPlane" alt="" coords="355,85,534,126"/>
<area shape="rect" id="node4" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="868,275,1008,301"/>
<area shape="rect" id="node5" href="experiment_8h.html#af35f4f27dfc0aab6ff2c4bf1dd1e9b4a" title="electronScatteringSmallGrid\l_init9" alt="" coords="351,150,539,191"/>
<area shape="rect" id="node6" href="experiment_8h.html#aba97ca9ea25115ea974bfeb9c86f0720" title="scatteringInEMWave" alt="" coords="372,216,517,243"/>
<area shape="rect" id="node7" href="main_8c.html#ac0f2228420376f4db7e1274f2b41667c" title="main" alt="" coords="661,115,711,141"/>
<area shape="rect" id="node9" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="862,56,1014,83"/>
<area shape="rect" id="node10" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="898,107,978,133"/>
<area shape="rect" id="node11" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="866,157,1010,184"/>
<area shape="rect" id="node12" href="experiment_8h.html#a2d41ecb76886c918dd5778010c03ab6e" title="testScattering" alt="" coords="886,5,990,32"/>
<area shape="rect" id="node13" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="833,209,1043,250"/>
<area shape="rect" id="node15" href="lw_fields_8h.html#ad8dbdc1271ca06b419d54acc97bcd8e2" title="this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustHyz_im1()&quot;, &quot;adjustHxz_jm1()&quot; and &quot;adjustHxy_km1()&quot; method. " alt="" coords="393,317,496,344"/>
<area shape="rect" id="node16" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="641,165,731,192"/>
<area shape="rect" id="node17" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="845,325,1031,352"/>
<area shape="rect" id="node21" href="lw_fields_8h.html#ab7a60b207d6d07de2f2f9ed4f0507c50" title="this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustEyz_ip1()&quot;, &quot;adjustExz_jp1()&quot; and &quot;adjustExy_kp1()&quot; method. " alt="" coords="393,372,496,399"/>
<area shape="rect" id="node22" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="641,216,731,243"/>
<area shape="rect" id="node26" href="calculations_8h.html#a5d8ed902b351b331f64c2f2b10ce8488" title="calcualtes Liénard&#45;Wiechert Fields everywhere on the grid. Each point on the grid is considered to be..." alt="" coords="614,435,758,461"/>
<area shape="rect" id="node27" href="calculations_8h.html#a333f7c0ac8a981945502dbf30fab0b3a" title="updates the near field region of a particle. If the particle moves into another box the near field re..." alt="" coords="626,317,746,344"/>
<area shape="rect" id="node28" href="calculations_8h.html#a270dd08201ef3f6cd773222bd3ff06cf" title="calcualtes LW fields on complete grid by looping through all boxes. In the near field region of each ..." alt="" coords="587,369,785,410"/>
<area shape="rect" id="node29" href="experiment_8h.html#a5b14baa3986802af9e003740cbc19217" title="electronScatteringLargeGrid\l_init8" alt="" coords="843,377,1033,418"/>
</map>
</div>

</div>
</div>
<a id="a31e3c429ce6db01564dba954fe965a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e3c429ce6db01564dba954fe965a78">&#9670;&nbsp;</a></span>addLWFieldsInBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addLWFieldsInBox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>adds LW fields in box specified by input parameter "boxIndex" </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to an instance of a <a class="el" href="struct_grid.html">Grid</a> struct. </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_particle.html">Particle</a></td><td>pointer to an instance of a <a class="el" href="struct_particle.html">Particle</a> struct </td></tr>
    <tr><td class="paramname">boxIndex</td><td>specified box in which fields shall be calcualted </td></tr>
    <tr><td class="paramname">t</td><td>time at which the fields shall be calcualted. This is also the zeroth component of xObserver </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>translate box index into number of box in x,y and z direction first (ib, jb, kb). Then calculate the gridIndex of the lower left corner of the current box and start looping through all grid points in that box. Each gridpoint is the current observation point, where fields shall be calcualted. Also grid index is updated each time the current grid point changes in the loop. Then add Lw field at that point. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_cgraph.png" border="0" usemap="#lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_cgraph" alt=""/></div>
<map name="lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_cgraph" id="lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_cgraph">
<area shape="rect" id="node2" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="187,161,280,188"/>
<area shape="rect" id="node3" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="338,27,522,53"/>
<area shape="rect" id="node6" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="343,81,517,108"/>
<area shape="rect" id="node9" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="379,132,481,159"/>
<area shape="rect" id="node10" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="344,183,516,225"/>
<area shape="rect" id="node11" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="369,249,491,276"/>
<area shape="rect" id="node12" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="328,300,532,327"/>
<area shape="rect" id="node4" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="813,5,932,32"/>
<area shape="rect" id="node5" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="618,27,722,53"/>
<area shape="rect" id="node7" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="580,78,760,119"/>
<area shape="rect" id="node8" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="808,85,937,112"/>
<area shape="rect" id="node13" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="620,300,720,327"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_icgraph.png" border="0" usemap="#lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_icgraph" alt=""/></div>
<map name="lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_icgraph" id="lw_fields_8c_a31e3c429ce6db01564dba954fe965a78_icgraph">
<area shape="rect" id="node2" href="calculations_8h.html#a5d8ed902b351b331f64c2f2b10ce8488" title="calcualtes Liénard&#45;Wiechert Fields everywhere on the grid. Each point on the grid is considered to be..." alt="" coords="214,64,358,91"/>
<area shape="rect" id="node3" href="calculations_8h.html#a333f7c0ac8a981945502dbf30fab0b3a" title="updates the near field region of a particle. If the particle moves into another box the near field re..." alt="" coords="226,115,346,141"/>
<area shape="rect" id="node8" href="calculations_8h.html#a270dd08201ef3f6cd773222bd3ff06cf" title="calcualtes LW fields on complete grid by looping through all boxes. In the near field region of each ..." alt="" coords="187,166,385,207"/>
<area shape="rect" id="node4" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="466,56,610,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="468,5,608,32"/>
<area shape="rect" id="node6" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="445,173,631,200"/>
<area shape="rect" id="node7" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="433,107,643,149"/>
<area shape="rect" id="node9" href="experiment_8h.html#a5b14baa3986802af9e003740cbc19217" title="electronScatteringLargeGrid\l_init8" alt="" coords="443,225,633,266"/>
</map>
</div>

</div>
</div>
<a id="ab7a60b207d6d07de2f2f9ed4f0507c50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7a60b207d6d07de2f2f9ed4f0507c50">&#9670;&nbsp;</a></span>adjustEFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustEFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in "adjustEyz_ip1()", "adjustExz_jp1()" and "adjustExy_kp1()" method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_cgraph.png" border="0" usemap="#lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_cgraph" alt=""/></div>
<map name="lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_cgraph" id="lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_cgraph">
<area shape="rect" id="node2" href="lw_fields_8c.html#ae05dc350695f83d10835578077f7ce61" title="this method adjusts the E values on the left and right side border of the near field. " alt="" coords="158,107,263,133"/>
<area shape="rect" id="node20" href="lw_fields_8c.html#ac917d3c7ad39bc896aa96ce84ad0d71c" title="this method adjusts the E values infront and on the back side border of the near field. " alt="" coords="158,208,263,235"/>
<area shape="rect" id="node22" href="lw_fields_8c.html#aceb9e81297ffee9719f4267301baa19b" title="this method adjusts the E values at top and bottom side border of the near field. ..." alt="" coords="156,157,265,184"/>
<area shape="rect" id="node3" href="calculations_8c.html#a9f530e232a5918981b4efe6edee87a01" title="calcBoxIndexIp1" alt="" coords="344,56,464,83"/>
<area shape="rect" id="node4" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="313,208,495,235"/>
<area shape="rect" id="node7" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="358,107,450,133"/>
<area shape="rect" id="node19" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="357,157,451,184"/>
<area shape="rect" id="node5" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="543,325,756,366"/>
<area shape="rect" id="node6" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="804,332,1008,359"/>
<area shape="rect" id="node8" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="557,157,741,184"/>
<area shape="rect" id="node11" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="563,56,736,83"/>
<area shape="rect" id="node14" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="598,208,701,235"/>
<area shape="rect" id="node15" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="563,259,735,301"/>
<area shape="rect" id="node16" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="588,5,711,32"/>
<area shape="rect" id="node17" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="547,107,751,133"/>
<area shape="rect" id="node9" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="1061,128,1180,155"/>
<area shape="rect" id="node10" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="854,208,958,235"/>
<area shape="rect" id="node12" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="816,41,996,82"/>
<area shape="rect" id="node13" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="1056,48,1185,75"/>
<area shape="rect" id="node18" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="856,107,956,133"/>
<area shape="rect" id="node21" href="calculations_8c.html#a91bbcdcec7d3406c78ca2de7e0fd04d5" title="calcBoxIndexJp1" alt="" coords="343,309,465,336"/>
<area shape="rect" id="node23" href="calculations_8c.html#a78ac4cd5aeb7e56277aa9543877ccdc0" title="calcBoxIndexKp1" alt="" coords="341,259,467,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_icgraph.png" border="0" usemap="#lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_icgraph" alt=""/></div>
<map name="lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_icgraph" id="lw_fields_8c_ab7a60b207d6d07de2f2f9ed4f0507c50_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="156,132,245,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="322,5,474,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="358,56,438,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="326,107,470,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="328,157,468,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="305,208,491,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="293,259,503,301"/>
</map>
</div>

</div>
</div>
<a id="aceb9e81297ffee9719f4267301baa19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb9e81297ffee9719f4267301baa19b">&#9670;&nbsp;</a></span>adjustExy_kp1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustExy_kp1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method adjusts the E values at top and bottom side border of the near field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">boxIndex</td><td>current boxIndex from outer loop </td></tr>
    <tr><td class="paramname">ib</td><td>boxIndex in x direction </td></tr>
    <tr><td class="paramname">jb</td><td>boxIndex in y direction </td></tr>
    <tr><td class="paramname">kb</td><td>boxIndex in z direction </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>this method gets called over and over again from "adjustEFields()" method while looping through all boxes. We check if the current box with boxIndex is in the near field of a particle and the box with boxIndexKp1 is not. Then we are at the top side border of the near field. Since we want to push a value for the Hfield inside the near field we need (among others) the E field value above. Since this point is in the far field the LW fields are already stored on that grid point. Therefore we need to substract the LW field to push the value inside the near field correctly. On the other hand, if we are on the bottom side border of the near field, i.e. current box is the not in near field but boxIndexKp1 is, then we push HField values from the far field. For this we need values above, i.e. in the near field. Since in the near field area no LW fields are stored, we need to calculate them and add them to push the H field value in the far field correctly. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_cgraph.png" border="0" usemap="#lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_cgraph" alt=""/></div>
<map name="lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_cgraph" id="lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a78ac4cd5aeb7e56277aa9543877ccdc0" title="calcBoxIndexKp1" alt="" coords="191,86,316,113"/>
<area shape="rect" id="node3" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="163,137,344,163"/>
<area shape="rect" id="node6" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="207,187,299,214"/>
<area shape="rect" id="node18" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="207,238,300,265"/>
<area shape="rect" id="node4" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="392,5,605,47"/>
<area shape="rect" id="node5" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="653,13,857,39"/>
<area shape="rect" id="node7" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="407,289,591,315"/>
<area shape="rect" id="node10" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="412,187,585,214"/>
<area shape="rect" id="node13" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="447,339,550,366"/>
<area shape="rect" id="node14" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="413,71,585,112"/>
<area shape="rect" id="node15" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="437,137,560,163"/>
<area shape="rect" id="node16" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="397,238,601,265"/>
<area shape="rect" id="node8" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="911,285,1029,311"/>
<area shape="rect" id="node9" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="703,289,807,315"/>
<area shape="rect" id="node11" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="665,172,845,213"/>
<area shape="rect" id="node12" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="905,179,1035,206"/>
<area shape="rect" id="node17" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="705,238,805,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_icgraph.png" border="0" usemap="#lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_icgraph" alt=""/></div>
<map name="lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_icgraph" id="lw_fields_8c_aceb9e81297ffee9719f4267301baa19b_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#ab7a60b207d6d07de2f2f9ed4f0507c50" title="this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustEyz_ip1()&quot;, &quot;adjustExz_jp1()&quot; and &quot;adjustExy_kp1()&quot; method. " alt="" coords="163,132,265,159"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="313,132,403,159"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="479,5,631,32"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="515,56,595,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="483,107,627,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="485,157,625,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="462,208,649,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="451,259,660,301"/>
</map>
</div>

</div>
</div>
<a id="ac917d3c7ad39bc896aa96ce84ad0d71c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac917d3c7ad39bc896aa96ce84ad0d71c">&#9670;&nbsp;</a></span>adjustExz_jp1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustExz_jp1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method adjusts the E values infront and on the back side border of the near field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">boxIndex</td><td>current boxIndex from outer loop </td></tr>
    <tr><td class="paramname">ib</td><td>boxIndex in x direction </td></tr>
    <tr><td class="paramname">jb</td><td>boxIndex in y direction </td></tr>
    <tr><td class="paramname">kb</td><td>boxIndex in z direction </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>this method gets called over and over again from "adjustEFields()" method while looping through all boxes. We check if the current box with boxIndex is in the near field of a particle and the box with boxIndexJp1 is not. Then we are at the back side border of the near field. Since we want to push a value for the Hfield inside the near field we need (among others) the E field value behind. Since this point is in the far field the LW fields are already stored on that grid point. Therefore we need to substract the LW field to push the value inside the near field correctly. On the other hand, if we are on the front side border of the near field, i.e. current box is the not in near field but boxIndexJp1 is, then we push HField values from the far field. For this we need values infront, i.e. in the near field. Since in the near field area no LW fields are stored, we need to calculate them and add them to push the H field value in the far field correctly. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_cgraph.png" border="0" usemap="#lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_cgraph" alt=""/></div>
<map name="lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_cgraph" id="lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a91bbcdcec7d3406c78ca2de7e0fd04d5" title="calcBoxIndexJp1" alt="" coords="188,86,311,113"/>
<area shape="rect" id="node3" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="159,137,340,163"/>
<area shape="rect" id="node6" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="203,187,295,214"/>
<area shape="rect" id="node18" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="203,238,296,265"/>
<area shape="rect" id="node4" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="388,5,601,47"/>
<area shape="rect" id="node5" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="649,13,853,39"/>
<area shape="rect" id="node7" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="403,289,587,315"/>
<area shape="rect" id="node10" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="408,187,581,214"/>
<area shape="rect" id="node13" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="443,339,546,366"/>
<area shape="rect" id="node14" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="409,71,581,112"/>
<area shape="rect" id="node15" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="433,137,556,163"/>
<area shape="rect" id="node16" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="393,238,597,265"/>
<area shape="rect" id="node8" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="907,285,1025,311"/>
<area shape="rect" id="node9" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="699,289,803,315"/>
<area shape="rect" id="node11" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="661,172,841,213"/>
<area shape="rect" id="node12" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="901,179,1031,206"/>
<area shape="rect" id="node17" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="701,238,801,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_icgraph.png" border="0" usemap="#lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_icgraph" alt=""/></div>
<map name="lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_icgraph" id="lw_fields_8c_ac917d3c7ad39bc896aa96ce84ad0d71c_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#ab7a60b207d6d07de2f2f9ed4f0507c50" title="this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustEyz_ip1()&quot;, &quot;adjustExz_jp1()&quot; and &quot;adjustExy_kp1()&quot; method. " alt="" coords="159,132,261,159"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="309,132,399,159"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="475,5,627,32"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="511,56,591,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="479,107,623,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="481,157,621,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="458,208,645,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="447,259,656,301"/>
</map>
</div>

</div>
</div>
<a id="ae05dc350695f83d10835578077f7ce61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae05dc350695f83d10835578077f7ce61">&#9670;&nbsp;</a></span>adjustEyz_ip1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustEyz_ip1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method adjusts the E values on the left and right side border of the near field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">boxIndex</td><td>current boxIndex from outer loop </td></tr>
    <tr><td class="paramname">ib</td><td>boxIndex in x direction </td></tr>
    <tr><td class="paramname">jb</td><td>boxIndex in y direction </td></tr>
    <tr><td class="paramname">kb</td><td>boxIndex in z direction </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>this method gets called over and over again from "adjustEFields()" method while looping through all boxes. We check if the current box with boxIndex is in the near field of a particle and the box with boxIndexIp1 is not. Then we are at the right border of the near field. Since we want to push a value for the Hfield inside the near field we need (among others) the E field value to the right. Since this point is in the far field the LW fields are already stored on that grid point. Therefore we need to substract the LW field to push the value inside the near field correctly. On the other hand, if we are on the left border of the near field, i.e. current box is the not in near field but boxIndexIp1 is, then we push HField values from the far field. For this we need values to the rigth, i.e. in the near field. Since in the near field area no LW fields are stored, we need to calculate them and add them to push the H field value in the far field correctly. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ae05dc350695f83d10835578077f7ce61_cgraph.png" border="0" usemap="#lw_fields_8c_ae05dc350695f83d10835578077f7ce61_cgraph" alt=""/></div>
<map name="lw_fields_8c_ae05dc350695f83d10835578077f7ce61_cgraph" id="lw_fields_8c_ae05dc350695f83d10835578077f7ce61_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a9f530e232a5918981b4efe6edee87a01" title="calcBoxIndexIp1" alt="" coords="189,86,309,113"/>
<area shape="rect" id="node3" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="159,137,340,163"/>
<area shape="rect" id="node6" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="203,187,295,214"/>
<area shape="rect" id="node18" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="203,238,296,265"/>
<area shape="rect" id="node4" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="388,5,601,47"/>
<area shape="rect" id="node5" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="649,13,853,39"/>
<area shape="rect" id="node7" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="403,289,587,315"/>
<area shape="rect" id="node10" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="408,187,581,214"/>
<area shape="rect" id="node13" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="443,339,546,366"/>
<area shape="rect" id="node14" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="409,71,581,112"/>
<area shape="rect" id="node15" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="433,137,556,163"/>
<area shape="rect" id="node16" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="393,238,597,265"/>
<area shape="rect" id="node8" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="907,285,1025,311"/>
<area shape="rect" id="node9" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="699,289,803,315"/>
<area shape="rect" id="node11" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="661,172,841,213"/>
<area shape="rect" id="node12" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="901,179,1031,206"/>
<area shape="rect" id="node17" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="701,238,801,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ae05dc350695f83d10835578077f7ce61_icgraph.png" border="0" usemap="#lw_fields_8c_ae05dc350695f83d10835578077f7ce61_icgraph" alt=""/></div>
<map name="lw_fields_8c_ae05dc350695f83d10835578077f7ce61_icgraph" id="lw_fields_8c_ae05dc350695f83d10835578077f7ce61_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#ab7a60b207d6d07de2f2f9ed4f0507c50" title="this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustEyz_ip1()&quot;, &quot;adjustExz_jp1()&quot; and &quot;adjustExy_kp1()&quot; method. " alt="" coords="159,132,261,159"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="309,132,399,159"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="475,5,627,32"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="511,56,591,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="479,107,623,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="481,157,621,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="458,208,645,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="447,259,656,301"/>
</map>
</div>

</div>
</div>
<a id="ad8dbdc1271ca06b419d54acc97bcd8e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8dbdc1271ca06b419d54acc97bcd8e2">&#9670;&nbsp;</a></span>adjustHFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustHFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in "adjustHyz_im1()", "adjustHxz_jm1()" and "adjustHxy_km1()" method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_cgraph.png" border="0" usemap="#lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_cgraph" alt=""/></div>
<map name="lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_cgraph" id="lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_cgraph">
<area shape="rect" id="node2" href="lw_fields_8c.html#adc8ac4e291df72434f59801ae4431349" title="this method adjusts the H values on the left and right side border of the near field. " alt="" coords="158,107,267,133"/>
<area shape="rect" id="node20" href="lw_fields_8c.html#a3e5719955e373b30ae2de7e6b91829eb" title="this method adjusts the H values infront and on the back side border of the near field. " alt="" coords="158,208,267,235"/>
<area shape="rect" id="node22" href="lw_fields_8c.html#aefc1a6143e678da91f19584c826428cd" title="this method adjusts the H values on the top and bottom side border of the near field. " alt="" coords="156,157,269,184"/>
<area shape="rect" id="node3" href="calculations_8c.html#adb1e1ed963b15e1e05fa5681af66b005" title="calcBoxIndexIm1" alt="" coords="346,56,470,83"/>
<area shape="rect" id="node4" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="317,208,499,235"/>
<area shape="rect" id="node7" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="362,107,454,133"/>
<area shape="rect" id="node19" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="361,157,455,184"/>
<area shape="rect" id="node5" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="547,325,760,366"/>
<area shape="rect" id="node6" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="808,332,1012,359"/>
<area shape="rect" id="node8" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="561,157,745,184"/>
<area shape="rect" id="node11" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="567,56,740,83"/>
<area shape="rect" id="node14" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="602,208,705,235"/>
<area shape="rect" id="node15" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="567,259,739,301"/>
<area shape="rect" id="node16" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="592,5,715,32"/>
<area shape="rect" id="node17" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="551,107,755,133"/>
<area shape="rect" id="node9" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="1065,128,1184,155"/>
<area shape="rect" id="node10" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="858,208,962,235"/>
<area shape="rect" id="node12" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="820,41,1000,82"/>
<area shape="rect" id="node13" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="1060,48,1189,75"/>
<area shape="rect" id="node18" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="860,107,960,133"/>
<area shape="rect" id="node21" href="calculations_8c.html#a31b2824a548acf6c7c181397ea41b643" title="calcBoxIndexJm1" alt="" coords="345,309,471,336"/>
<area shape="rect" id="node23" href="calculations_8c.html#a23447665efada367a850bebc6b3787ff" title="calcBoxIndexKm1" alt="" coords="343,259,473,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_icgraph.png" border="0" usemap="#lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_icgraph" alt=""/></div>
<map name="lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_icgraph" id="lw_fields_8c_ad8dbdc1271ca06b419d54acc97bcd8e2_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="156,132,245,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="322,5,474,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="358,56,438,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="326,107,470,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="328,157,468,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="305,208,491,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="293,259,503,301"/>
</map>
</div>

</div>
</div>
<a id="aefc1a6143e678da91f19584c826428cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefc1a6143e678da91f19584c826428cd">&#9670;&nbsp;</a></span>adjustHxy_km1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustHxy_km1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method adjusts the H values on the top and bottom side border of the near field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">boxIndex</td><td>current boxIndex from outer loop </td></tr>
    <tr><td class="paramname">ib</td><td>boxIndex in x direction </td></tr>
    <tr><td class="paramname">jb</td><td>boxIndex in y direction </td></tr>
    <tr><td class="paramname">kb</td><td>boxIndex in z direction </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>this method gets called over and over again from "adjustHFields()" method while looping through all boxes. We check if the current box with boxIndex is in the near field of a particle and the box with boxIndexKm1 is not. Then we are at bottom border of the near field. Since we want to push a value for the Efield inside the near field we need (among others) the value below. Since this point is in the far field the LW fields are already stored on that grid point. Therefore we need to substract the LW field to push the value inside the near field correctly. On the other hand, if we are on the top border of the near field, i.e. current box is the not in near field but boxIndexKm1 is, then we push EField values from the far field. For this we need values below, i.e. in the near field. Since in the near field area no LW fields are stored, we need to calculate them and add them to push the E field value in the far field correctly. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_aefc1a6143e678da91f19584c826428cd_cgraph.png" border="0" usemap="#lw_fields_8c_aefc1a6143e678da91f19584c826428cd_cgraph" alt=""/></div>
<map name="lw_fields_8c_aefc1a6143e678da91f19584c826428cd_cgraph" id="lw_fields_8c_aefc1a6143e678da91f19584c826428cd_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a23447665efada367a850bebc6b3787ff" title="calcBoxIndexKm1" alt="" coords="193,86,322,113"/>
<area shape="rect" id="node3" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="167,137,348,163"/>
<area shape="rect" id="node6" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="211,187,303,214"/>
<area shape="rect" id="node18" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="211,238,304,265"/>
<area shape="rect" id="node4" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="396,5,609,47"/>
<area shape="rect" id="node5" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="657,13,861,39"/>
<area shape="rect" id="node7" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="411,289,595,315"/>
<area shape="rect" id="node10" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="416,187,589,214"/>
<area shape="rect" id="node13" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="451,339,554,366"/>
<area shape="rect" id="node14" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="417,71,589,112"/>
<area shape="rect" id="node15" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="441,137,564,163"/>
<area shape="rect" id="node16" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="401,238,605,265"/>
<area shape="rect" id="node8" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="915,285,1033,311"/>
<area shape="rect" id="node9" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="707,289,811,315"/>
<area shape="rect" id="node11" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="669,172,849,213"/>
<area shape="rect" id="node12" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="909,179,1039,206"/>
<area shape="rect" id="node17" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="709,238,809,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_aefc1a6143e678da91f19584c826428cd_icgraph.png" border="0" usemap="#lw_fields_8c_aefc1a6143e678da91f19584c826428cd_icgraph" alt=""/></div>
<map name="lw_fields_8c_aefc1a6143e678da91f19584c826428cd_icgraph" id="lw_fields_8c_aefc1a6143e678da91f19584c826428cd_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#ad8dbdc1271ca06b419d54acc97bcd8e2" title="this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustHyz_im1()&quot;, &quot;adjustHxz_jm1()&quot; and &quot;adjustHxy_km1()&quot; method. " alt="" coords="167,132,269,159"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="317,132,407,159"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="483,5,635,32"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="519,56,599,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="487,107,631,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="489,157,629,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="466,208,653,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="455,259,664,301"/>
</map>
</div>

</div>
</div>
<a id="a3e5719955e373b30ae2de7e6b91829eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5719955e373b30ae2de7e6b91829eb">&#9670;&nbsp;</a></span>adjustHxz_jm1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustHxz_jm1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method adjusts the H values infront and on the back side border of the near field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">boxIndex</td><td>current boxIndex from outer loop </td></tr>
    <tr><td class="paramname">ib</td><td>boxIndex in x direction </td></tr>
    <tr><td class="paramname">jb</td><td>boxIndex in y direction </td></tr>
    <tr><td class="paramname">kb</td><td>boxIndex in z direction </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>this method gets called over and over again from "adjustHFields()" method while looping through all boxes. We check if the current box with boxIndex is in the near field of a particle and the box with boxIndexJm1 is not. Then we are at the facing border of the near field. Since we want to push a value for the Efield inside the near field we need (among others) the value infront. Since this point is in the far field the LW fields are already stored on that grid point. Therefore we need to substract the LW field to push the value inside the near field correctly. On the other hand, if we are on the back border of the near field, i.e. current box is the not in near field but boxIndexJm1 is, then we push EField values from the far field. For this we need values infront, i.e. in the near field. Since in the near field area no LW fields are stored, we need to calculate them and add them to push the E field value in the far field correctly. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_cgraph.png" border="0" usemap="#lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_cgraph" alt=""/></div>
<map name="lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_cgraph" id="lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a31b2824a548acf6c7c181397ea41b643" title="calcBoxIndexJm1" alt="" coords="190,86,317,113"/>
<area shape="rect" id="node3" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="163,137,344,163"/>
<area shape="rect" id="node6" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="207,187,299,214"/>
<area shape="rect" id="node18" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="207,238,300,265"/>
<area shape="rect" id="node4" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="392,5,605,47"/>
<area shape="rect" id="node5" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="653,13,857,39"/>
<area shape="rect" id="node7" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="407,289,591,315"/>
<area shape="rect" id="node10" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="412,187,585,214"/>
<area shape="rect" id="node13" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="447,339,550,366"/>
<area shape="rect" id="node14" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="413,71,585,112"/>
<area shape="rect" id="node15" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="437,137,560,163"/>
<area shape="rect" id="node16" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="397,238,601,265"/>
<area shape="rect" id="node8" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="911,285,1029,311"/>
<area shape="rect" id="node9" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="703,289,807,315"/>
<area shape="rect" id="node11" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="665,172,845,213"/>
<area shape="rect" id="node12" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="905,179,1035,206"/>
<area shape="rect" id="node17" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="705,238,805,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_icgraph.png" border="0" usemap="#lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_icgraph" alt=""/></div>
<map name="lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_icgraph" id="lw_fields_8c_a3e5719955e373b30ae2de7e6b91829eb_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#ad8dbdc1271ca06b419d54acc97bcd8e2" title="this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustHyz_im1()&quot;, &quot;adjustHxz_jm1()&quot; and &quot;adjustHxy_km1()&quot; method. " alt="" coords="163,132,265,159"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="313,132,403,159"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="479,5,631,32"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="515,56,595,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="483,107,627,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="485,157,625,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="462,208,649,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="451,259,660,301"/>
</map>
</div>

</div>
</div>
<a id="adc8ac4e291df72434f59801ae4431349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8ac4e291df72434f59801ae4431349">&#9670;&nbsp;</a></span>adjustHyz_im1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adjustHyz_im1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>kb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this method adjusts the H values on the left and right side border of the near field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>pointer to Particles struct array </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">boxIndex</td><td>current boxIndex from outer loop </td></tr>
    <tr><td class="paramname">ib</td><td>boxIndex in x direction </td></tr>
    <tr><td class="paramname">jb</td><td>boxIndex in y direction </td></tr>
    <tr><td class="paramname">kb</td><td>boxIndex in z direction </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>this method gets called over and over again from "adjustHFields()" method while looping through all boxes. We check if the current box with boxIndex is in the near field of a particle and the box with boxIndexIm1 is not. Then we are at the left border of the near field. Since we want to push a value for the Efield inside the near field we need (among others) the value to the left. Since this point is in the far field, the LW fields are already stored on that grid point. Therefore we need to substract the LW field to push the value inside the near field correctly. On the other hand, if we are on the right border of the near field, i.e. current box is the not in near field but boxIndexIm1 is, then we push EField values from the far field. For this we need values to the left, i.e. in the near field. Since in the near field area no LW fields are stored, we need to calculate them and add them to push the E field value in the far field correctly. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_adc8ac4e291df72434f59801ae4431349_cgraph.png" border="0" usemap="#lw_fields_8c_adc8ac4e291df72434f59801ae4431349_cgraph" alt=""/></div>
<map name="lw_fields_8c_adc8ac4e291df72434f59801ae4431349_cgraph" id="lw_fields_8c_adc8ac4e291df72434f59801ae4431349_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#adb1e1ed963b15e1e05fa5681af66b005" title="calcBoxIndexIm1" alt="" coords="191,86,315,113"/>
<area shape="rect" id="node3" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="163,137,344,163"/>
<area shape="rect" id="node6" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="207,187,299,214"/>
<area shape="rect" id="node18" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="207,238,300,265"/>
<area shape="rect" id="node4" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="392,5,605,47"/>
<area shape="rect" id="node5" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="653,13,857,39"/>
<area shape="rect" id="node7" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="407,289,591,315"/>
<area shape="rect" id="node10" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="412,187,585,214"/>
<area shape="rect" id="node13" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="447,339,550,366"/>
<area shape="rect" id="node14" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="413,71,585,112"/>
<area shape="rect" id="node15" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="437,137,560,163"/>
<area shape="rect" id="node16" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="397,238,601,265"/>
<area shape="rect" id="node8" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="911,285,1029,311"/>
<area shape="rect" id="node9" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="703,289,807,315"/>
<area shape="rect" id="node11" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="665,172,845,213"/>
<area shape="rect" id="node12" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="905,179,1035,206"/>
<area shape="rect" id="node17" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="705,238,805,265"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_adc8ac4e291df72434f59801ae4431349_icgraph.png" border="0" usemap="#lw_fields_8c_adc8ac4e291df72434f59801ae4431349_icgraph" alt=""/></div>
<map name="lw_fields_8c_adc8ac4e291df72434f59801ae4431349_icgraph" id="lw_fields_8c_adc8ac4e291df72434f59801ae4431349_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#ad8dbdc1271ca06b419d54acc97bcd8e2" title="this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustHyz_im1()&quot;, &quot;adjustHxz_jm1()&quot; and &quot;adjustHxy_km1()&quot; method. " alt="" coords="163,132,265,159"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="313,132,403,159"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="479,5,631,32"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="515,56,595,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="483,107,627,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="485,157,625,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="462,208,649,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="451,259,660,301"/>
</map>
</div>

</div>
</div>
<a id="a476da358b14047cff9fbfd11e46bb275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a476da358b14047cff9fbfd11e46bb275">&#9670;&nbsp;</a></span>pushEField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushEField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally pushes E field at box borders. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>instance of <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>struct containing all particles </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
    <tr><td class="paramname">dt</td><td>time increment </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_cgraph.png" border="0" usemap="#lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_cgraph" alt=""/></div>
<map name="lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_cgraph" id="lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_cgraph">
<area shape="rect" id="node2" href="lw_fields_8c.html#a472e4ed96bca43242a8b4e94b15991d1" title="Maxwell Pusher for EField inside Boxes. This method is used for the hybrid field method. " alt="" coords="143,56,304,83"/>
<area shape="rect" id="node3" href="lw_fields_8c.html#a764fbbefccc598e48988dab3371f808b" title="this methods loops through all boxes and stores all values of H in the plane left, infront and below of the current box. As can be seen from the Yee Scheme only Hy and Hz are needed from the left plane. Hz and Hx are needed from the plane infront and Hy and Hx are needed from the plane below. If the current box is a box where to the left does not exist (ib = 0) then the respective values for H are set to 0. " alt="" coords="152,107,295,133"/>
<area shape="rect" id="node4" href="lw_fields_8c.html#ad8dbdc1271ca06b419d54acc97bcd8e2" title="this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustHyz_im1()&quot;, &quot;adjustHxz_jm1()&quot; and &quot;adjustHxy_km1()&quot; method. " alt="" coords="172,157,275,184"/>
<area shape="rect" id="node27" href="lw_fields_8c.html#a8542932ce0ccd85e67cd10d0a0ff81eb" title="Maxwell Pusher for EField at box borders. This method is used for the hybrid field method..." alt="" coords="149,208,297,235"/>
<area shape="rect" id="node5" href="lw_fields_8c.html#adc8ac4e291df72434f59801ae4431349" title="this method adjusts the H values on the left and right side border of the near field. " alt="" coords="354,107,463,133"/>
<area shape="rect" id="node23" href="lw_fields_8c.html#a3e5719955e373b30ae2de7e6b91829eb" title="this method adjusts the H values infront and on the back side border of the near field. " alt="" coords="354,208,463,235"/>
<area shape="rect" id="node25" href="lw_fields_8c.html#aefc1a6143e678da91f19584c826428cd" title="this method adjusts the H values on the top and bottom side border of the near field. " alt="" coords="352,157,465,184"/>
<area shape="rect" id="node6" href="calculations_8c.html#adb1e1ed963b15e1e05fa5681af66b005" title="calcBoxIndexIm1" alt="" coords="542,56,666,83"/>
<area shape="rect" id="node7" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="513,208,695,235"/>
<area shape="rect" id="node10" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="558,107,650,133"/>
<area shape="rect" id="node22" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="557,157,651,184"/>
<area shape="rect" id="node8" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="743,325,956,366"/>
<area shape="rect" id="node9" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="1004,332,1208,359"/>
<area shape="rect" id="node11" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="757,157,941,184"/>
<area shape="rect" id="node14" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="763,56,936,83"/>
<area shape="rect" id="node17" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="798,208,901,235"/>
<area shape="rect" id="node18" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="763,259,935,301"/>
<area shape="rect" id="node19" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="788,5,911,32"/>
<area shape="rect" id="node20" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="747,107,951,133"/>
<area shape="rect" id="node12" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="1261,128,1380,155"/>
<area shape="rect" id="node13" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="1054,208,1158,235"/>
<area shape="rect" id="node15" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="1016,41,1196,82"/>
<area shape="rect" id="node16" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="1256,48,1385,75"/>
<area shape="rect" id="node21" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="1056,107,1156,133"/>
<area shape="rect" id="node24" href="calculations_8c.html#a31b2824a548acf6c7c181397ea41b643" title="calcBoxIndexJm1" alt="" coords="541,309,667,336"/>
<area shape="rect" id="node26" href="calculations_8c.html#a23447665efada367a850bebc6b3787ff" title="calcBoxIndexKm1" alt="" coords="539,259,669,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_icgraph.png" border="0" usemap="#lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_icgraph" alt=""/></div>
<map name="lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_icgraph" id="lw_fields_8c_a476da358b14047cff9fbfd11e46bb275_icgraph">
<area shape="rect" id="node2" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="171,5,323,32"/>
<area shape="rect" id="node3" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="207,56,287,83"/>
<area shape="rect" id="node4" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="175,107,319,133"/>
<area shape="rect" id="node5" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="177,157,317,184"/>
<area shape="rect" id="node6" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="154,208,341,235"/>
<area shape="rect" id="node7" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="143,259,352,301"/>
</map>
</div>

</div>
</div>
<a id="a8542932ce0ccd85e67cd10d0a0ff81eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8542932ce0ccd85e67cd10d0a0ff81eb">&#9670;&nbsp;</a></span>pushEFieldAtBorders()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushEFieldAtBorders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maxwell Pusher for EField at box borders. This method is used for the hybrid field method. </p>
<dl class="section remark"><dt>Remarks</dt><dd>E field is calculated via negative curl. Therefore value of H on the left side of E on the grid is required. Thus start i,j,k with 1. UPML is activated by default </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">dt</td><td>time increment </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a8542932ce0ccd85e67cd10d0a0ff81eb_icgraph.png" border="0" usemap="#lw_fields_8c_a8542932ce0ccd85e67cd10d0a0ff81eb_icgraph" alt=""/></div>
<map name="lw_fields_8c_a8542932ce0ccd85e67cd10d0a0ff81eb_icgraph" id="lw_fields_8c_a8542932ce0ccd85e67cd10d0a0ff81eb_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="201,132,291,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="367,5,519,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="403,56,483,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="371,107,515,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="373,157,513,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="350,208,537,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="339,259,548,301"/>
</map>
</div>

</div>
</div>
<a id="a472e4ed96bca43242a8b4e94b15991d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a472e4ed96bca43242a8b4e94b15991d1">&#9670;&nbsp;</a></span>pushEFieldInsideBoxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushEFieldInsideBoxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maxwell Pusher for EField inside Boxes. This method is used for the hybrid field method. </p>
<dl class="section remark"><dt>Remarks</dt><dd>E field is calculated via negative curl. Therefore value of H on the left side of E on the grid is required. Thus start i,j,k with 1. UPML is activated by default </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>instance of <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">dt</td><td>time increment </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a472e4ed96bca43242a8b4e94b15991d1_icgraph.png" border="0" usemap="#lw_fields_8c_a472e4ed96bca43242a8b4e94b15991d1_icgraph" alt=""/></div>
<map name="lw_fields_8c_a472e4ed96bca43242a8b4e94b15991d1_icgraph" id="lw_fields_8c_a472e4ed96bca43242a8b4e94b15991d1_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="215,132,304,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="381,5,533,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="417,56,497,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="385,107,529,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="387,157,527,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="363,208,550,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="352,259,561,301"/>
</map>
</div>

</div>
</div>
<a id="af45e2e7d9e6c006510383e5295410fa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af45e2e7d9e6c006510383e5295410fa8">&#9670;&nbsp;</a></span>pushHField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushHField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numberOfParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally pushes H field at box borders. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>instance of <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Particles</td><td>struct containing all particles </td></tr>
    <tr><td class="paramname">numberOfParticles</td><td>number of particles </td></tr>
    <tr><td class="paramname">t</td><td>current simulation time </td></tr>
    <tr><td class="paramname">dt</td><td>time increment </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_cgraph.png" border="0" usemap="#lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_cgraph" alt=""/></div>
<map name="lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_cgraph" id="lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_cgraph">
<area shape="rect" id="node2" href="lw_fields_8c.html#a4138b9989d8810aa35e0e6c1e0ea4fe0" title="Maxwell Pusher for HField inside Boxes. This method is used for the hybrid field method. " alt="" coords="143,56,305,83"/>
<area shape="rect" id="node3" href="lw_fields_8c.html#a46580d5ee2d7d0ae9277aee52395f565" title="this methods loops through all boxes and stores all values of E in the plane right, behind and above of the current box. As can be seen from the Yee Scheme only Ey and Ez are needed from the right plane. Ez and Ex are needed from the plane behind and Ey and Ex are needed from the plane above. If the current box is a box where the plane to the right does not exist (ib = numberOfBoxesInX) then the respective values for E are set to 0. " alt="" coords="153,107,295,133"/>
<area shape="rect" id="node4" href="lw_fields_8c.html#ab7a60b207d6d07de2f2f9ed4f0507c50" title="this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustEyz_ip1()&quot;, &quot;adjustExz_jp1()&quot; and &quot;adjustExy_kp1()&quot; method. " alt="" coords="173,157,275,184"/>
<area shape="rect" id="node27" href="lw_fields_8c.html#ae76bc3c422d73fce2c5c4ac84f8e5d6e" title="Maxwell Pusher for HField at box borders. This method is used for the hybrid field method..." alt="" coords="149,208,299,235"/>
<area shape="rect" id="node5" href="lw_fields_8c.html#ae05dc350695f83d10835578077f7ce61" title="this method adjusts the E values on the left and right side border of the near field. " alt="" coords="355,107,461,133"/>
<area shape="rect" id="node23" href="lw_fields_8c.html#ac917d3c7ad39bc896aa96ce84ad0d71c" title="this method adjusts the E values infront and on the back side border of the near field. " alt="" coords="355,208,461,235"/>
<area shape="rect" id="node25" href="lw_fields_8c.html#aceb9e81297ffee9719f4267301baa19b" title="this method adjusts the E values at top and bottom side border of the near field. ..." alt="" coords="353,157,463,184"/>
<area shape="rect" id="node6" href="calculations_8c.html#a9f530e232a5918981b4efe6edee87a01" title="calcBoxIndexIp1" alt="" coords="541,56,661,83"/>
<area shape="rect" id="node7" href="calculations_8c.html#ab63ddedc6da8245a582deb4070082f12" title="boxIsInNearFieldOfParticle" alt="" coords="511,208,692,235"/>
<area shape="rect" id="node10" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="555,107,647,133"/>
<area shape="rect" id="node22" href="lw_fields_8c.html#accd066409e3d31d783b6695e00a001d7" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="555,157,648,184"/>
<area shape="rect" id="node8" href="calculations_8c.html#a4f47621e229194f09741578119708259" title="calcualtes the indices of next neighbour boxes from current particle position and saves them in boxIn..." alt="" coords="740,325,953,366"/>
<area shape="rect" id="node9" href="calculations_8c.html#a7e0480084af24bf17eded3e04b7d4c98" title="calcualtes the box index in which the particle is currently located. " alt="" coords="1001,332,1205,359"/>
<area shape="rect" id="node11" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="755,157,939,184"/>
<area shape="rect" id="node14" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="760,56,933,83"/>
<area shape="rect" id="node17" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="795,208,898,235"/>
<area shape="rect" id="node18" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="761,259,933,301"/>
<area shape="rect" id="node19" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="785,5,908,32"/>
<area shape="rect" id="node20" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="745,107,949,133"/>
<area shape="rect" id="node12" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="1259,128,1377,155"/>
<area shape="rect" id="node13" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="1051,208,1155,235"/>
<area shape="rect" id="node15" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="1013,41,1193,82"/>
<area shape="rect" id="node16" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="1253,48,1383,75"/>
<area shape="rect" id="node21" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="1053,107,1153,133"/>
<area shape="rect" id="node24" href="calculations_8c.html#a91bbcdcec7d3406c78ca2de7e0fd04d5" title="calcBoxIndexJp1" alt="" coords="540,309,663,336"/>
<area shape="rect" id="node26" href="calculations_8c.html#a78ac4cd5aeb7e56277aa9543877ccdc0" title="calcBoxIndexKp1" alt="" coords="539,259,664,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_icgraph.png" border="0" usemap="#lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_icgraph" alt=""/></div>
<map name="lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_icgraph" id="lw_fields_8c_af45e2e7d9e6c006510383e5295410fa8_icgraph">
<area shape="rect" id="node2" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="171,5,323,32"/>
<area shape="rect" id="node3" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="207,56,287,83"/>
<area shape="rect" id="node4" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="175,107,319,133"/>
<area shape="rect" id="node5" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="177,157,317,184"/>
<area shape="rect" id="node6" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="154,208,341,235"/>
<area shape="rect" id="node7" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="143,259,352,301"/>
</map>
</div>

</div>
</div>
<a id="ae76bc3c422d73fce2c5c4ac84f8e5d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae76bc3c422d73fce2c5c4ac84f8e5d6e">&#9670;&nbsp;</a></span>pushHFieldAtBorders()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushHFieldAtBorders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maxwell Pusher for HField at box borders. This method is used for the hybrid field method. </p>
<dl class="section remark"><dt>Remarks</dt><dd>H field is calculated via positive curl. Therefore value of E on the right side of H on the grid is required. Thus stop i,j,k at n - 1 where n denotes the numberOfGridPoints. UPML is activated by default </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">dt</td><td>time increment </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_ae76bc3c422d73fce2c5c4ac84f8e5d6e_icgraph.png" border="0" usemap="#lw_fields_8c_ae76bc3c422d73fce2c5c4ac84f8e5d6e_icgraph" alt=""/></div>
<map name="lw_fields_8c_ae76bc3c422d73fce2c5c4ac84f8e5d6e_icgraph" id="lw_fields_8c_ae76bc3c422d73fce2c5c4ac84f8e5d6e_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="203,132,292,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="369,5,521,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="405,56,485,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="373,107,517,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="375,157,515,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="351,208,538,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="340,259,549,301"/>
</map>
</div>

</div>
</div>
<a id="a4138b9989d8810aa35e0e6c1e0ea4fe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4138b9989d8810aa35e0e6c1e0ea4fe0">&#9670;&nbsp;</a></span>pushHFieldInsideBoxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushHFieldInsideBoxes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maxwell Pusher for HField inside Boxes. This method is used for the hybrid field method. </p>
<dl class="section remark"><dt>Remarks</dt><dd>H field is calculated via positive curl. Therefore value of E on the right side of H on the grid is required. Thus stop i,j,k at n - 1 where n denotes the numberOfGridPoints. UPML is activated by default </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>instance of <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">dt</td><td>time increment </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a4138b9989d8810aa35e0e6c1e0ea4fe0_icgraph.png" border="0" usemap="#lw_fields_8c_a4138b9989d8810aa35e0e6c1e0ea4fe0_icgraph" alt=""/></div>
<map name="lw_fields_8c_a4138b9989d8810aa35e0e6c1e0ea4fe0_icgraph" id="lw_fields_8c_a4138b9989d8810aa35e0e6c1e0ea4fe0_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="216,132,305,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="382,5,534,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="418,56,498,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="386,107,530,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="388,157,528,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="365,208,551,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="353,259,563,301"/>
</map>
</div>

</div>
</div>
<a id="a46580d5ee2d7d0ae9277aee52395f565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46580d5ee2d7d0ae9277aee52395f565">&#9670;&nbsp;</a></span>setEFieldOnBorders()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setEFieldOnBorders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this methods loops through all boxes and stores all values of E in the plane right, behind and above of the current box. As can be seen from the Yee Scheme only Ey and Ez are needed from the right plane. Ez and Ex are needed from the plane behind and Ey and Ex are needed from the plane above. If the current box is a box where the plane to the right does not exist (ib = numberOfBoxesInX) then the respective values for E are set to 0. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Ey_ip1 and all others are matrices. The first index denotes the boxIndex and the second Index the gridPoints in the plane. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a46580d5ee2d7d0ae9277aee52395f565_icgraph.png" border="0" usemap="#lw_fields_8c_a46580d5ee2d7d0ae9277aee52395f565_icgraph" alt=""/></div>
<map name="lw_fields_8c_a46580d5ee2d7d0ae9277aee52395f565_icgraph" id="lw_fields_8c_a46580d5ee2d7d0ae9277aee52395f565_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="196,132,285,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="362,5,514,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="398,56,478,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="366,107,510,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="368,157,508,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="345,208,531,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="333,259,543,301"/>
</map>
</div>

</div>
</div>
<a id="a764fbbefccc598e48988dab3371f808b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a764fbbefccc598e48988dab3371f808b">&#9670;&nbsp;</a></span>setHFieldOnBorders()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setHFieldOnBorders </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this methods loops through all boxes and stores all values of H in the plane left, infront and below of the current box. As can be seen from the Yee Scheme only Hy and Hz are needed from the left plane. Hz and Hx are needed from the plane infront and Hy and Hx are needed from the plane below. If the current box is a box where to the left does not exist (ib = 0) then the respective values for H are set to 0. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Hz_im1 and all others are matrices. The first index denotes the boxIndex and the second Index the gridPoints in the plane. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a764fbbefccc598e48988dab3371f808b_icgraph.png" border="0" usemap="#lw_fields_8c_a764fbbefccc598e48988dab3371f808b_icgraph" alt=""/></div>
<map name="lw_fields_8c_a764fbbefccc598e48988dab3371f808b_icgraph" id="lw_fields_8c_a764fbbefccc598e48988dab3371f808b_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="196,132,285,159"/>
<area shape="rect" id="node3" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="362,5,514,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="398,56,478,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="366,107,510,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="368,157,508,184"/>
<area shape="rect" id="node7" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="345,208,531,235"/>
<area shape="rect" id="node8" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="333,259,543,301"/>
</map>
</div>

</div>
</div>
<a id="a96197f1e2e5444c3f9f16b528a453f2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96197f1e2e5444c3f9f16b528a453f2f">&#9670;&nbsp;</a></span>subLWField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void subLWField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xObserver</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>component</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>adds LW fields at grid point with index "gridIndexInBox". Each point on the grid is considered to be the observation point, where the zeroth component is the current simulation time and also the time at which we want to calculate the fields. Therefore loop through the particle xhistory vector up to the current simulation time and search for the pair of positions which fulfil the condition that the old position is inside and the new position is outside the backward lightcone of the observation point. Once that pair of positions is found the rest of the xHistory vector can be skipped because all following points will be outside as well. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to an instance of a <a class="el" href="struct_grid.html">Grid</a> struct. </td></tr>
    <tr><td class="paramname">xObserver</td><td>observation point at which the LW fields ahall be calculted </td></tr>
    <tr><td class="paramname">component</td><td>component in which the observation point shall be shifted. </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_particle.html">Particle</a></td><td>pointer to an instance of a <a class="el" href="struct_particle.html">Particle</a> struct </td></tr>
    <tr><td class="paramname">destination</td><td>pointer to where LW fields shall be subtracted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>the Yee-scheme requires that the E and B fields are shifted against each other. Maybe the switch case is not neccessary. But I didn't tested it yet. For the staggering a xObservationCopy vector is introduced, which is used for field calculations, so that the original xObservation vector is left untouched. After staggering took place the currentHistoryLength property of <a class="el" href="struct_particle.html">Particle</a> struct is used as upper loop index. By doing this, this method (and all above the chain) can be used either within the outer simulation loop to calculate the fileds every time step (video) or afterwards to caluclate the fields just once. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_cgraph.png" border="0" usemap="#lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_cgraph" alt=""/></div>
<map name="lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_cgraph" id="lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_cgraph">
<area shape="rect" id="node2" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="155,27,339,53"/>
<area shape="rect" id="node5" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="161,81,334,108"/>
<area shape="rect" id="node8" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="196,132,299,159"/>
<area shape="rect" id="node9" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="161,183,333,225"/>
<area shape="rect" id="node10" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="186,249,309,276"/>
<area shape="rect" id="node11" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="145,300,349,327"/>
<area shape="rect" id="node3" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="631,5,749,32"/>
<area shape="rect" id="node4" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="435,27,539,53"/>
<area shape="rect" id="node6" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="397,78,577,119"/>
<area shape="rect" id="node7" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="625,85,755,112"/>
<area shape="rect" id="node12" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="437,300,537,327"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_icgraph.png" border="0" usemap="#lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_icgraph" alt=""/></div>
<map name="lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_icgraph" id="lw_fields_8c_a96197f1e2e5444c3f9f16b528a453f2f_icgraph">
<area shape="rect" id="node2" href="lw_fields_8h.html#adc8ac4e291df72434f59801ae4431349" title="this method adjusts the H values on the left and right side border of the near field. " alt="" coords="147,157,257,184"/>
<area shape="rect" id="node11" href="lw_fields_8h.html#a3e5719955e373b30ae2de7e6b91829eb" title="this method adjusts the H values infront and on the back side border of the near field. " alt="" coords="147,208,257,235"/>
<area shape="rect" id="node12" href="lw_fields_8h.html#aefc1a6143e678da91f19584c826428cd" title="this method adjusts the H values on the top and bottom side border of the near field. " alt="" coords="145,259,259,285"/>
<area shape="rect" id="node13" href="lw_fields_8h.html#ae05dc350695f83d10835578077f7ce61" title="this method adjusts the E values on the left and right side border of the near field. " alt="" coords="149,5,255,32"/>
<area shape="rect" id="node16" href="lw_fields_8h.html#ac917d3c7ad39bc896aa96ce84ad0d71c" title="this method adjusts the E values infront and on the back side border of the near field. " alt="" coords="149,56,255,83"/>
<area shape="rect" id="node17" href="lw_fields_8h.html#aceb9e81297ffee9719f4267301baa19b" title="this method adjusts the E values at top and bottom side border of the near field. ..." alt="" coords="147,107,257,133"/>
<area shape="rect" id="node18" href="lw_fields_8h.html#a296507eaeaf163c36b80660b879cd330" title="subtracts LW fields in box specified by input parameter &quot;boxIndex&quot; " alt="" coords="307,284,440,311"/>
<area shape="rect" id="node3" href="lw_fields_8h.html#ad8dbdc1271ca06b419d54acc97bcd8e2" title="this method loops through all boxes and adjusts the H fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustHyz_im1()&quot;, &quot;adjustHxz_jm1()&quot; and &quot;adjustHxy_km1()&quot; method. " alt="" coords="322,208,425,235"/>
<area shape="rect" id="node4" href="lw_fields_8h.html#a476da358b14047cff9fbfd11e46bb275" title="pushes E field inside Boxes. Sets H field at box borders. Adjusts H fields at box borders and finally..." alt="" coords="503,208,593,235"/>
<area shape="rect" id="node5" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="685,56,837,83"/>
<area shape="rect" id="node6" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="721,107,801,133"/>
<area shape="rect" id="node7" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="689,157,833,184"/>
<area shape="rect" id="node8" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="691,208,831,235"/>
<area shape="rect" id="node9" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="667,259,854,285"/>
<area shape="rect" id="node10" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="656,310,865,351"/>
<area shape="rect" id="node14" href="lw_fields_8h.html#ab7a60b207d6d07de2f2f9ed4f0507c50" title="this method loops through all boxes and adjusts the E fields in the plane to the left, infront and below. The actual adjustemnt takes place in &quot;adjustEyz_ip1()&quot;, &quot;adjustExz_jp1()&quot; and &quot;adjustExy_kp1()&quot; method. " alt="" coords="322,81,425,108"/>
<area shape="rect" id="node15" href="lw_fields_8h.html#af45e2e7d9e6c006510383e5295410fa8" title="pushes H field inside Boxes. Sets E field at box borders. Adjusts E fields at box borders and finally..." alt="" coords="503,157,593,184"/>
<area shape="rect" id="node19" href="calculations_8h.html#a333f7c0ac8a981945502dbf30fab0b3a" title="updates the near field region of a particle. If the particle moves into another box the near field re..." alt="" coords="488,259,608,285"/>
</map>
</div>

</div>
</div>
<a id="a296507eaeaf163c36b80660b879cd330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a296507eaeaf163c36b80660b879cd330">&#9670;&nbsp;</a></span>subLWFieldsInBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void subLWFieldsInBox </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boxIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>subtracts LW fields in box specified by input parameter "boxIndex" </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>pointer to an instance of a <a class="el" href="struct_grid.html">Grid</a> struct. </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_particle.html">Particle</a></td><td>pointer to an instance of a <a class="el" href="struct_particle.html">Particle</a> struct </td></tr>
    <tr><td class="paramname">boxIndex</td><td>specified box in which fields shall be calcualted </td></tr>
    <tr><td class="paramname">t</td><td>time at which the fields shall be calcualted. This is also the zeroth component of xObserver </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>translate box index into number of box in x,y and z direction first (ib, jb, kb). Then calculate the gridIndex of the lower left corner of the current box and start looping through all grid points in that box. Each gridpoint is the current observation point, where fields shall be calcualted. Also grid index is updated each time the current grid point changes in the loop. Then sub Lw field at that point. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a296507eaeaf163c36b80660b879cd330_cgraph.png" border="0" usemap="#lw_fields_8c_a296507eaeaf163c36b80660b879cd330_cgraph" alt=""/></div>
<map name="lw_fields_8c_a296507eaeaf163c36b80660b879cd330_cgraph" id="lw_fields_8c_a296507eaeaf163c36b80660b879cd330_cgraph">
<area shape="rect" id="node2" href="lw_fields_8c.html#a96197f1e2e5444c3f9f16b528a453f2f" title="adds LW fields at grid point with index &quot;gridIndexInBox&quot;. Each point on the grid is considered to be ..." alt="" coords="187,161,279,188"/>
<area shape="rect" id="node3" href="calculations_8c.html#a770c5d06af64ec4c44828f0d187dd3f5" title="true if position of particle is inside the backward lightcone of the observer, otherwise false..." alt="" coords="337,27,521,53"/>
<area shape="rect" id="node6" href="calculations_8c.html#a5de1d92c531e59f82bde88373178ec39" title="calculateIntersectionPoint" alt="" coords="342,81,515,108"/>
<area shape="rect" id="node9" href="calculations_8c.html#ab5a57fc028df589b0c2e685c03a2dc3e" title="calcuates acceleration of particle " alt="" coords="377,132,480,159"/>
<area shape="rect" id="node10" href="calculations_8c.html#ae8153fed945275e7b543372ba73d5a8b" title="updates location x for particles with velocity u using x = v * dt time component x[0] gets updated as..." alt="" coords="343,183,515,225"/>
<area shape="rect" id="node11" href="calculations_8c.html#aad3a0aa662c097cc6aa1c8e5fd35f2ed" title="calcultes time derivative in each component of beta. " alt="" coords="367,249,490,276"/>
<area shape="rect" id="node12" href="calculations_8c.html#a8793862cf844e854b5acaa30b9a63ff6" title="calculates LW fields from formula " alt="" coords="327,300,531,327"/>
<area shape="rect" id="node4" href="calculations_8c.html#abf8f0fc7a9dda22c0b3ca897b1287a2c" title="calcualtes the vector difference of spatial dimensions of the two four vectors and saves the result i..." alt="" coords="812,5,931,32"/>
<area shape="rect" id="node5" href="calculations_8c.html#a2c4af1aebe183def86b489823f7a5e43" title="vectorProduct" alt="" coords="617,27,721,53"/>
<area shape="rect" id="node7" href="calculations_8c.html#acbce4e3cd63f64eda54d827e6d91eb67" title="returns parameter lambda for the linear interpolation between particle trajectory and backwards light..." alt="" coords="579,78,759,119"/>
<area shape="rect" id="node8" href="calculations_8c.html#af147ce40bad8abab7f620dbbc5bfd040" title="minkowskiProduct" alt="" coords="807,85,936,112"/>
<area shape="rect" id="node13" href="calculations_8c.html#af3e1a8686943f2507047e9519a111a0a" title="calculates the cross product of two vectors &quot;a&quot; and &quot;b&quot; and saves the result in array &quot;result&quot; ..." alt="" coords="619,300,719,327"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a296507eaeaf163c36b80660b879cd330_icgraph.png" border="0" usemap="#lw_fields_8c_a296507eaeaf163c36b80660b879cd330_icgraph" alt=""/></div>
<map name="lw_fields_8c_a296507eaeaf163c36b80660b879cd330_icgraph" id="lw_fields_8c_a296507eaeaf163c36b80660b879cd330_icgraph">
<area shape="rect" id="node2" href="calculations_8h.html#a333f7c0ac8a981945502dbf30fab0b3a" title="updates the near field region of a particle. If the particle moves into another box the near field re..." alt="" coords="187,81,307,108"/>
<area shape="rect" id="node3" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="387,5,531,32"/>
<area shape="rect" id="node4" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="389,56,529,83"/>
<area shape="rect" id="node5" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="366,107,553,133"/>
<area shape="rect" id="node6" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="355,158,564,199"/>
</map>
</div>

</div>
</div>
<a id="a11d47532e4411c70d5cb6adaa199e68e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11d47532e4411c70d5cb6adaa199e68e">&#9670;&nbsp;</a></span>updateFieldsForParticlePush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateFieldsForParticlePush </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>Particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Eextern</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bextern</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>E</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>in order to push the current particle properly not just the external fields but also the field contributions from other particles propagated into the near field region need to be taken into account. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_particle.html">Particle</a></td><td>instance of <a class="el" href="struct_particle.html">Particle</a> struct </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>instance of <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
    <tr><td class="paramname">Eextern</td><td>vector containing external E field components </td></tr>
    <tr><td class="paramname">Bextern</td><td>vector containing external B field components </td></tr>
    <tr><td class="paramname">E</td><td>vector containg both external fields and those from other particles propagated into the near field region of the current particle </td></tr>
    <tr><td class="paramname">B</td><td>vector containg both external fields and those from other particles propagated into the near field region of the current particle </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_cgraph.png" border="0" usemap="#lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_cgraph" alt=""/></div>
<map name="lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_cgraph" id="lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_cgraph">
<area shape="rect" id="node2" href="calculations_8h.html#a69926635ff8dec5008380035b6be532b" title="interpolateFields" alt="" coords="247,5,367,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_icgraph.png" border="0" usemap="#lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_icgraph" alt=""/></div>
<map name="lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_icgraph" id="lw_fields_8c_a11d47532e4411c70d5cb6adaa199e68e_icgraph">
<area shape="rect" id="node2" href="calculations_8h.html#abc30b03964ca466fdf0a089dfefd0dae" title="updates velocity with boris method. " alt="" coords="247,323,456,350"/>
<area shape="rect" id="node3" href="calculations_8c.html#aaa3f91ed7132a457ca21ca23da463b59" title="performs a reverse Boris Push. Uses same methods like standard BorisPusher but uses &#45;E und &#45;B..." alt="" coords="530,120,657,147"/>
<area shape="rect" id="node4" href="calculations_8h.html#adbff8a7444a6b76f6ae268b1925506d0" title="extends and calculates particle history up to time t. Example: Let&#39;s say t = 8 and tEnd = 12 then the..." alt="" coords="731,152,879,179"/>
<area shape="rect" id="node5" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="938,19,1125,46"/>
<area shape="rect" id="node6" href="experiment_8h.html#a2d41ecb76886c918dd5778010c03ab6e" title="testScattering" alt="" coords="979,72,1083,99"/>
<area shape="rect" id="node7" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="927,192,1136,233"/>
<area shape="rect" id="node8" href="experiment_8h.html#af35f4f27dfc0aab6ff2c4bf1dd1e9b4a" title="electronScatteringSmallGrid\l_init9" alt="" coords="937,257,1125,298"/>
<area shape="rect" id="node10" href="experiment_8h.html#aba97ca9ea25115ea974bfeb9c86f0720" title="scatteringInEMWave" alt="" coords="959,323,1104,350"/>
<area shape="rect" id="node12" href="experiment_8h.html#a48fa4b50c818d762b95f86e04195b0a2" title="testBorisPusher" alt="" coords="535,374,651,400"/>
<area shape="rect" id="node13" href="experiment_8h.html#a93af21472ce6a2cf691bb5fb9a2555b5" title="testLWFieldCalculationFor\lPlane" alt="" coords="504,425,683,466"/>
<area shape="rect" id="node14" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="517,491,669,518"/>
<area shape="rect" id="node15" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="553,542,633,568"/>
<area shape="rect" id="node16" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="521,592,665,619"/>
<area shape="rect" id="node17" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="523,643,663,670"/>
<area shape="rect" id="node9" href="experiment_8h.html#a5b14baa3986802af9e003740cbc19217" title="electronScatteringLargeGrid\l_init8" alt="" coords="937,126,1126,168"/>
<area shape="rect" id="node11" href="main_8c.html#ac0f2228420376f4db7e1274f2b41667c" title="main" alt="" coords="1184,323,1235,350"/>
</map>
</div>

</div>
</div>
<a id="a38c9fdb75dd81fd9029d1a65c4d5a567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c9fdb75dd81fd9029d1a65c4d5a567">&#9670;&nbsp;</a></span>writeFieldsFromCompleteGridToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeFieldsFromCompleteGridToFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loops through the entire grid and writes respective E and B values to E_initalFields.txt and H_initialFields.txt respectively. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="struct_grid.html">Grid</a></td><td>instance of <a class="el" href="struct_grid.html">Grid</a> struct </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a38c9fdb75dd81fd9029d1a65c4d5a567_icgraph.png" border="0" usemap="#lw_fields_8c_a38c9fdb75dd81fd9029d1a65c4d5a567_icgraph" alt=""/></div>
<map name="lw_fields_8c_a38c9fdb75dd81fd9029d1a65c4d5a567_icgraph" id="lw_fields_8c_a38c9fdb75dd81fd9029d1a65c4d5a567_icgraph">
<area shape="rect" id="node2" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="252,5,461,47"/>
<area shape="rect" id="node3" href="experiment_8h.html#a5b14baa3986802af9e003740cbc19217" title="electronScatteringLargeGrid\l_init8" alt="" coords="262,71,451,112"/>
</map>
</div>

</div>
</div>
<a id="a02f39870c725f9dd68cef0f8d06a481e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f39870c725f9dd68cef0f8d06a481e">&#9670;&nbsp;</a></span>writeFieldsToFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeFieldsToFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>planeForPlotting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>plotE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>plotB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loops through the entire E and B array and writes |B|^2 and |E|^2 to seperate files. File is structured similiar to the grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>pointer to a char. Gets modified inside the method </td></tr>
    <tr><td class="paramname">index</td><td>outer loop index. Is used to name the output file </td></tr>
    <tr><td class="paramname">plotE</td><td>set to true, if you want to write E-field to file </td></tr>
    <tr><td class="paramname">plotB</td><td>set to true, if you want to write B-field to file </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">ERROR</td><td>Could not open file for E or B field </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="lw_fields_8c_a02f39870c725f9dd68cef0f8d06a481e_icgraph.png" border="0" usemap="#lw_fields_8c_a02f39870c725f9dd68cef0f8d06a481e_icgraph" alt=""/></div>
<map name="lw_fields_8c_a02f39870c725f9dd68cef0f8d06a481e_icgraph" id="lw_fields_8c_a02f39870c725f9dd68cef0f8d06a481e_icgraph">
<area shape="rect" id="node2" href="experiment_8h.html#ab1fee8000e98d5da702493e433bf111c" title="testMaxwellPusher" alt="" coords="214,5,347,32"/>
<area shape="rect" id="node3" href="experiment_8h.html#a93af21472ce6a2cf691bb5fb9a2555b5" title="testLWFieldCalculationFor\lPlane" alt="" coords="191,57,370,98"/>
<area shape="rect" id="node4" href="experiment_8h.html#afa945de4c746fc5a517cf69a5ac36543" title="testNearAndFarFields" alt="" coords="205,123,357,149"/>
<area shape="rect" id="node5" href="experiment_8h.html#a35aeaaa9c59b63ebb3b1bd44eee47660" title="testUPML" alt="" coords="241,173,321,200"/>
<area shape="rect" id="node6" href="experiment_8h.html#acd27e8d50cbba15a38c1f28f3b5f83e0" title="testNearFieldUpdate" alt="" coords="209,224,353,251"/>
<area shape="rect" id="node7" href="experiment_8h.html#ad224439ef154d4551b879f0fff5403b9" title="testMultipleParticles" alt="" coords="211,275,351,301"/>
<area shape="rect" id="node8" href="experiment_8h.html#a3e9d738020dbbe2a6f6c524a4756af30" title="testHistoryBeforeSimulation" alt="" coords="187,325,374,352"/>
<area shape="rect" id="node9" href="experiment_8h.html#a2d41ecb76886c918dd5778010c03ab6e" title="testScattering" alt="" coords="229,376,333,403"/>
<area shape="rect" id="node10" href="experiment_8h.html#a7e5f074daf8512b8c1a8b77d4fcd4175" title="extendHistoryAndCalcLWFields\lIndependantly" alt="" coords="176,427,385,469"/>
<area shape="rect" id="node11" href="experiment_8h.html#af35f4f27dfc0aab6ff2c4bf1dd1e9b4a" title="electronScatteringSmallGrid\l_init9" alt="" coords="187,493,375,534"/>
<area shape="rect" id="node12" href="experiment_8h.html#a5b14baa3986802af9e003740cbc19217" title="electronScatteringLargeGrid\l_init8" alt="" coords="186,558,375,599"/>
<area shape="rect" id="node13" href="experiment_8h.html#aba97ca9ea25115ea974bfeb9c86f0720" title="scatteringInEMWave" alt="" coords="208,624,353,651"/>
<area shape="rect" id="node14" href="main_8c.html#ac0f2228420376f4db7e1274f2b41667c" title="main" alt="" coords="433,624,484,651"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a972f4ab940a1216ead45c573af8339d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a972f4ab940a1216ead45c573af8339d0">&#9670;&nbsp;</a></span>useUPML</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool useUPML = true</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
